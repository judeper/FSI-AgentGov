# Control 1.23: Step-Up Authentication for AI Agent Operations

**Control ID:** 1.23
**Pillar:** Security
**Regulatory Reference:** GLBA 501(b), FINRA 4511, SOX 302/404, NIST SP 800-63B
**Last UI Verified:** January 2026
**Governance Levels:** Baseline / Recommended / Regulated

---

## Objective

Implement step-up authentication requirements when AI agents attempt sensitive operations such as financial transactions, data exports, or access to restricted information, requiring re-authentication at the moment of high-risk action.

---

## Why This Matters for FSI

- **GLBA 501(b):** Verifies user identity before sensitive data access
- **FINRA 4511:** Ensures authorized access to financial records at transaction time
- **SOX 302/404:** Provides transaction-level authentication controls for internal control
- **NIST 800-63B:** Implements AAL2/AAL3 authentication strength for sensitive operations

---

## Control Description

This control establishes step-up authentication through:

1. **High-Risk Action Classification** - Define actions requiring step-up (financial transactions, data export, external API calls, config changes)
2. **Authentication Contexts** - Create Entra ID contexts (c1-c5) mapped to sensitive agent actions
3. **Conditional Access Policies** - Configure CA policies requiring fresh authentication for each context
4. **Phishing-Resistant MFA** - Mandate FIDO2/Windows Hello for critical operations
5. **Session Controls** - Configure sign-in frequency (15 minutes for critical actions)
6. **Step-Up Monitoring** - Alert on step-up failures and bypass attempts

---

## Key Configuration Points

- Create Authentication Contexts: `c1` (Financial Transaction), `c2` (Data Export), `c3` (External API), `c4` (Config Change), `c5` (Sensitive Query)
- Configure CA policies requiring phishing-resistant MFA for each context
- Set sign-in frequency: 15 minutes for critical (c1), 30 minutes for high (c2-c4), 1 hour for medium (c5)
- Require compliant device for step-up scenarios
- Implement service principal compensating controls (approval workflow for sensitive SP operations)
- Configure real-time alerting on step-up authentication failures
- Start CA policies in report-only mode before enforcement

### PIM Integration for Sensitive Agent Operations

Combine step-up authentication with PIM for administrative operations on AI agents:

| Operation | PIM Requirement | Step-Up Context | Combined Control |
|-----------|----------------|-----------------|------------------|
| **Agent Publishing (Zone 3)** | Activate Power Platform Admin | c4 (Config Change) | PIM + 30-min fresh auth |
| **Connector Allowlist Changes** | Activate Power Platform Admin | c4 (Config Change) | PIM + 30-min fresh auth |
| **Agent Deletion** | Activate Environment Admin | c4 (Config Change) | PIM + approval workflow |
| **DSPM Policy Changes** | Activate Purview Admin | c4 (Config Change) | PIM + 15-min fresh auth |
| **Agent Sponsor Assignment** | Activate AI Governance Lead | c5 (Sensitive Query) | PIM + justification required |

**PIM + Step-Up Workflow:**

1. User requests PIM activation for administrative role
2. PIM approval workflow triggers (requires approver consent)
3. Upon activation, step-up authentication context applied
4. User completes phishing-resistant MFA
5. Administrative operation permitted within activation window
6. All actions logged with PIM activation context for audit

---

## Zone-Specific Requirements

| Zone | Requirement | Rationale |
|------|-------------|-----------|
| **Zone 1** (Personal) | Standard MFA; 8-hour session; step-up not required | Low risk, minimal friction |
| **Zone 2** (Team) | Step-up for data exports and external API; 4-hour session; 30-minute fresh auth | Team data requires additional verification |
| **Zone 3** (Enterprise) | Mandatory step-up all sensitive actions; 1-hour session; 15-minute fresh auth; phishing-resistant MFA; real-time monitoring | Customer-facing requires strictest controls |

---

## Roles & Responsibilities

| Role | Responsibility |
|------|----------------|
| Entra Security Admin | Configure authentication contexts and CA policies |
| Entra Global Admin | Manage authentication strength and MFA methods |
| Power Platform Admin | Implement connector-level step-up requirements |
| Compliance Officer | Classify actions and validate regulatory alignment |

---

## Related Controls

| Control | Relationship |
|---------|--------------|
| [1.11 - Conditional Access](1.11-conditional-access-and-phishing-resistant-mfa.md) | Baseline CA policies; step-up builds on top |
| [1.4 - Advanced Connector Policies](1.4-advanced-connector-policies-acp.md) | Connector governance enables action-level step-up |
| [1.18 - RBAC](1.18-application-level-authorization-and-role-based-access-control-rbac.md) | Role-based access complements step-up |
| [1.7 - Audit Logging](1.7-comprehensive-audit-logging-and-compliance.md) | Step-up events must be logged |

---

## Implementation Guides

> For step-by-step implementation, see the playbooks:

- [Portal Walkthrough](../../playbooks/control-implementations/1.23/portal-walkthrough.md) - Step-by-step portal configuration
- [PowerShell Setup](../../playbooks/control-implementations/1.23/powershell-setup.md) - Scripts for automation
- [Verification & Testing](../../playbooks/control-implementations/1.23/verification-testing.md) - Test cases and evidence collection
- [Troubleshooting](../../playbooks/control-implementations/1.23/troubleshooting.md) - Common issues and resolutions

---

## Verification Criteria

Confirm control effectiveness by verifying:

1. Agent access without MFA is denied
2. Sensitive action after >15 minutes triggers step-up authentication
3. Step-up with FIDO2 key succeeds for critical action
4. Step-up with SMS is denied when phishing-resistant required
5. Step-up events appear in sign-in logs with authentication context

---

## Additional Resources

- [Microsoft Learn: Authentication Contexts](https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-cloud-apps#authentication-context)
- [Microsoft Learn: Authentication Strengths](https://learn.microsoft.com/en-us/entra/identity/authentication/concept-authentication-strengths)
- [Microsoft Learn: Session Controls](https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-session-lifetime)
- [NIST SP 800-63B: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/sp800-63b.html)

---

*Updated: January 2026 | Version: v1.2 | UI Verification Status: Current*
