# Control 1.7: Comprehensive Audit Logging and Compliance

**Control ID:** 1.7
**Pillar:** Security
**Regulatory Reference:** FINRA 4511, FINRA Notice 25-07, SEC 17a-3/4, SOX 302/404, GLBA 501(b)
**Last UI Verified:** January 2026
**Governance Levels:** Baseline / Recommended / Regulated

---

## Objective

Implement comprehensive audit logging to capture Microsoft 365 Copilot and Copilot Studio agent interactions, providing an evidence trail for regulatory examinations, security investigations, and compliance monitoring. For broker-dealers, this includes guidance supporting SEC 17a-4(f) compliance through either WORM storage or the audit-trail alternative (per October 2022 amendments, effective May 2023).

---

## Why This Matters for FSI

- **FINRA 4511:** Requires 6-year retention for customer records - agent interactions may constitute records
- **FINRA Notice 25-07:** Proposes AI-generated communications require complete prompt/response retention (RFC - final requirements pending)
- **SEC 17a-3/4:** Record retention for AI-assisted communications; broker-dealers may require WORM storage
- **SOX 302/404:** Internal controls over AI system logging require audit trails
- **GLBA 501(b):** Security safeguards including audit trails for data access

---

## Control Description

Microsoft Purview Audit provides comprehensive logging of user and admin activities across Microsoft 365, including Microsoft 365 Copilot and agent interactions. Audit logs are essential for compliance monitoring, security investigations, and regulatory examinations.

| Capability | Description |
|------------|-------------|
| Unified audit log | Single log for all M365 activities including Copilot |
| Agent activity logging | Captures agent creation, publishing, modification, and interactions |
| Extended retention | Up to 10 years with Audit Premium |
| Search and export | Advanced query and export for investigations |
| SIEM integration | Export to Sentinel or third-party SIEM |

### AI-Generated Communication Tagging (FINRA 25-07)

FINRA Regulatory Notice 25-07 requires firms to distinguish AI-generated communications from human-generated content in their records. Audit logging supports this by:

| Requirement | Implementation |
|-------------|----------------|
| **AI Origin Tagging** | CopilotInteraction events contain `ApplicationId` identifying Copilot/agent source |
| **Prompt/Response Pairs** | Full prompt and response captured via DSPM for AI (Control 1.6) |
| **Human vs AI Attribution** | Audit logs distinguish `UserId` (human initiator) from `AgentId` (AI responder) |
| **No Summary Storage** | Complete verbatim content retained per 25-07 (no truncation/summarization) |
| **Modification Tracking** | If human edits AI output before sending, both versions should be retained |

**Audit Event Types (RecordType values in OfficeActivity table):**

- `CopilotInteraction` - M365 Copilot interactions
- `CopilotForM365Interaction` - Copilot for Microsoft 365 events
- `AgentInteraction` - Copilot Studio agent interactions
- `AIAssistanceUsed` - AI assistance in document creation

!!! note "Querying AI Audit Events"
    These are **RecordType** values, not table names. Query via the `OfficeActivity` table
    in Log Analytics or use `Search-UnifiedAuditLog` PowerShell cmdlet with the
    `-RecordType` parameter.

---

## Key Configuration Points

- Enable unified audit logging at tenant level
- Configure retention policies per governance tier (180 days to 10 years)
- Search for agent-related activities: CopilotInteraction, AgentPublished, ConnectorAdded
- Export logs regularly for WORM storage (broker-dealers)
- Integrate with SIEM for real-time monitoring (Tier 2-3)
- Retain complete prompt/response pairs per FINRA 25-07 (no summaries)
- Implement adversarial pattern detection in audit log analysis

---

## Zone-Specific Requirements

| Zone | Requirement | Rationale |
|------|-------------|-----------|
| **Zone 1** (Personal) | Baseline logging; 180-day retention; monthly review | Low risk, standard coverage |
| **Zone 2** (Team) | 1+ year retention; weekly review; SIEM recommended | Shared agents require accountability |
| **Zone 3** (Enterprise) | 6+ year retention; daily review; WORM storage if broker-dealer; SIEM required | Highest regulatory risk |

---

## Roles & Responsibilities

| Role | Responsibility |
|------|----------------|
| Purview Audit Admin | Configure audit logging and retention policies |
| Compliance Administrator | Search and export audit logs for examinations |
| Security Operations | SIEM integration and monitoring |
| Azure Administrator | WORM storage configuration (if applicable) |

---

## Related Controls

| Control | Relationship |
|---------|--------------|
| [1.6 - DSPM for AI](1.6-microsoft-purview-dspm-for-ai.md) | AI interaction visibility |
| [1.19 - eDiscovery](1.19-ediscovery-for-agent-interactions.md) | Legal discovery |
| [3.2 - Usage Analytics](../pillar-3-reporting/3.2-usage-analytics-and-activity-monitoring.md) | Activity monitoring |
| [3.9 - Sentinel Integration](../pillar-3-reporting/3.9-microsoft-sentinel-integration.md) | SIEM integration |

---

## Implementation Guides

> For step-by-step implementation, see the playbooks:

- [Portal Walkthrough](../../playbooks/control-implementations/1.7/portal-walkthrough.md) - Step-by-step portal configuration
- [PowerShell Setup](../../playbooks/control-implementations/1.7/powershell-setup.md) - Scripts for automation
- [Verification & Testing](../../playbooks/control-implementations/1.7/verification-testing.md) - Test cases and evidence collection
- [Troubleshooting](../../playbooks/control-implementations/1.7/troubleshooting.md) - Common issues and resolutions

---

## Verification Criteria

Confirm control effectiveness by verifying:

1. Unified audit logging is enabled (Get-AdminAuditLogConfig shows enabled)
2. Copilot and agent events appear in audit search results
3. Retention policies are configured per governance tier
4. Export capability produces complete audit records
5. SIEM integration is functional (logs streaming to Sentinel)
6. WORM storage is configured for broker-dealer environments (if applicable)

---

## Additional Resources

- [Microsoft Learn: Microsoft Purview Audit Solutions](https://learn.microsoft.com/en-us/purview/audit-solutions-overview)
- [Microsoft Learn: Search the Audit Log](https://learn.microsoft.com/en-us/purview/audit-log-search)
- [Microsoft Learn: Audit Log Retention Policies](https://learn.microsoft.com/en-us/purview/audit-log-retention-policies)
- [Microsoft Learn: Azure Immutable Blob Storage](https://learn.microsoft.com/en-us/azure/storage/blobs/immutable-storage-overview)
- [Microsoft Learn: Office 365 Management Activity API](https://learn.microsoft.com/en-us/office/office-365-management-api/office-365-management-activity-api-reference)

### Microsoft Audit Reporting Tools

For enterprise-scale audit data export beyond native portal limits, see:

- [Microsoft Audit Reporting Tools Playbook](../../playbooks/advanced-implementations/microsoft-audit-reporting-tools.md) - PAX (Portable Audit eXporter) for large-scale audit extraction and AI-in-One Dashboard for adoption analytics

---

*Updated: January 2026 | Version: v1.1 | UI Verification Status: Current*
