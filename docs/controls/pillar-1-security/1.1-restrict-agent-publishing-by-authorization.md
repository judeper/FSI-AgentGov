# Control 1.1: Restrict Agent Publishing by Authorization

**Control ID:** 1.1
**Pillar:** Security
**Regulatory Reference:** FINRA 4511, SEC Rule 17a-4, GLBA 501(b)
**Last UI Verified:** January 2026
**Governance Levels:** Baseline / Recommended / Regulated

---

## Objective

Restrict who can publish AI agents to production environments by implementing security group-based authorization, separation of duties, and formal approval workflows.

---

## Why This Matters for FSI

- **FINRA 4511:** Requires records of authorized activities - only authorized makers should publish, with all publishing logged
- **SEC Rule 17a-4:** Publishing events must be captured in audit logs for examination
- **GLBA 501(b):** Restricting who can create agents protects customer data
- **SOX 302:** Publishing restrictions support segregation of duties requirements

---

## Control Description

This control establishes authorization controls over who can create and publish AI agents in Microsoft 365 and Power Platform. Since Microsoft does not provide a native toggle to disable agent creation, the governance strategy shifts from prevention to containment through:

1. **Block Publishing** - DLP policies block channel connectors
2. **Restrict Sharing** - Disable "Share with Everyone" capability
3. **Route Away** - Environment routing directs makers to governed environments

The control implements a "Sterile Default Environment Strategy" where the Default environment has all publishing channels blocked via DLP, combined with security group-based access control for designated maker environments.

---

## Key Configuration Points

- Create security groups: `FSI-Agent-Makers-*`, `FSI-Agent-Publishers-Prod`, `FSI-Agent-Approvers-Compliance`
- Remove Environment Maker role from "All Users" in each environment
- Assign Environment Maker only to authorized security groups
- Restrict Copilot Studio access to specific security groups
- Configure Managed Environment sharing limits
- Implement release gates with approval workflows for production publishing

---

## Zone-Specific Requirements

| Zone | Requirement | Rationale |
|------|-------------|-----------|
| **Zone 1** (Personal) | Any licensed user can create personal agents; no approval required | Low risk, no customer data |
| **Zone 2** (Team) | Security group membership required; manager approval before production | Internal data access requires accountability |
| **Zone 3** (Enterprise) | Strict group membership; Governance Committee + Legal review; quarterly certification | Customer-facing, regulatory examination risk |

---

## Roles & Responsibilities

| Role | Responsibility |
|------|----------------|
| Power Platform Admin | Configure environment security roles, Managed Environment settings |
| Entra Global Admin | Create and manage security groups in Entra ID |
| Compliance Officer | Approve production publishing, review audit logs |
| AI Governance Lead | Define approval workflow, governance tier requirements |

---

## Related Controls

| Control | Relationship |
|---------|--------------|
| [2.1 - Managed Environments](../pillar-2-management/2.1-managed-environments.md) | Enables sharing restrictions and governance features |
| [1.2 - Agent Registry](1.2-agent-registry-and-integrated-apps-management.md) | Tracks all published agents |
| [1.7 - Audit Logging](1.7-comprehensive-audit-logging-and-compliance.md) | Logs all publishing attempts |
| [2.3 - Change Management](../pillar-2-management/2.3-change-management-and-release-planning.md) | Approval workflow for promotions |

---

## Implementation Guides

> For step-by-step implementation, see the playbooks:

- [Portal Walkthrough](../../playbooks/control-implementations/1.1/portal-walkthrough.md) - Step-by-step portal configuration
- [PowerShell Setup](../../playbooks/control-implementations/1.1/powershell-setup.md) - Scripts for automation
- [Verification & Testing](../../playbooks/control-implementations/1.1/verification-testing.md) - Test cases and evidence collection
- [Troubleshooting](../../playbooks/control-implementations/1.1/troubleshooting.md) - Common issues and resolutions

---

## Verification Criteria

Confirm control effectiveness by verifying:

1. Non-authorized users cannot create or publish agents (test with non-member account)
2. Authorized users can create agents in designated environments
3. Production publishing requires membership in `FSI-Agent-Publishers-Prod`
4. All publish events appear in Microsoft Purview Audit logs
5. Sharing restrictions block "Share with Everyone" attempts

---

## Additional Resources

- [Microsoft Learn: Environment security](https://learn.microsoft.com/en-us/power-platform/admin/database-security)
- [Microsoft Learn: Security roles and privileges](https://learn.microsoft.com/en-us/power-platform/admin/security-roles-privileges)
- [Microsoft Learn: Copilot Studio security and governance](https://learn.microsoft.com/en-us/microsoft-copilot-studio/security-and-governance)
- [Microsoft Learn: Managed Environments - Limit sharing](https://learn.microsoft.com/en-us/power-platform/admin/managed-environment-sharing-limits)

---

*Updated: January 2026 | Version: v1.2 | UI Verification Status: Current*
