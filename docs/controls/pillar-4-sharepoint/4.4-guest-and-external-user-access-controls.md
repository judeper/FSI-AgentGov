# Control 4.4: Guest and External User Access Controls

**Control ID:** 4.4
**Pillar:** SharePoint
**Regulatory Reference:** GLBA 501(b), 504(b), SEC Reg S-P, FINRA 4511
**Last UI Verified:** January 2026
**Governance Levels:** Baseline / Recommended / Regulated

---

## Objective

Control external and guest user access to SharePoint content that may be used by AI agents. This prevents unauthorized external parties from accessing regulated content and ensures agent knowledge sources are protected from external exposure.

---

## Why This Matters for FSI

- **GLBA 501(b):** Protect nonpublic personal information (NPI) from unauthorized access; enterprise sites must block external sharing
- **SEC Reg S-P:** Safeguard customer information with controlled third-party access and expiration workflows
- **FINRA 4511:** Prevent unauthorized external access to regulated books and records
- **SOX 302/404:** Audit trails for guest access; certification requirements for internal controls

---

## Control Description

This control establishes policies for managing external and guest user access to SharePoint sites that serve as AI agent knowledge sources. Proper guest access controls are critical for financial institutions where agents may process sensitive financial data.

| Capability | Description |
|------------|-------------|
| **Site-Level Sharing** | Configure sharing permissions per site (Anyone / Guests / Existing Guests / Internal Only) |
| **Organization Policies** | Set default sharing restrictions across the tenant |
| **Guest Expiration** | Automatically expire guest access after defined period |
| **Domain Restrictions** | Allow or block sharing with specific domains |
| **Data Access Reports** | Monitor external sharing activity |

---

## Key Configuration Points

- Set organization-level sharing to "Existing guests" or more restrictive
- Disable external sharing for Zone 3 (Enterprise Managed) sites
- Configure guest access expiration (30 days for Zone 2, 90 days for Zone 1)
- Set default link type to "Internal" with view-only permissions
- Enable link expiration requirements (30 days maximum)
- Configure domain allowlist for approved external partners

---

## Zone-Specific Requirements

| Zone | Requirement | Rationale |
|------|-------------|-----------|
| **Zone 1** (Personal) | ExternalUserSharingOnly; 90-day guest expiration; site owner approval | Low risk; minimal friction while maintaining controls |
| **Zone 2** (Team) | ExistingExternalUserSharingOnly; 30-day expiration; manager + compliance approval | Shared agents increase blast radius; controls must be provable |
| **Zone 3** (Enterprise) | Sharing Disabled; no exceptions; continuous audit | Highest risk; enterprise agents handle sensitive content |

---

## Roles & Responsibilities

| Role | Responsibility |
|------|----------------|
| SharePoint Admin | Configure tenant and site sharing settings |
| Entra Global Admin | Configure guest access policies in Entra ID |
| Security Admin | Configure Conditional Access for guest users |
| Compliance Officer | Approve guest access and review requirements |

---

## Related Controls

| Control | Relationship |
|---------|--------------|
| [1.11 - Conditional Access](../pillar-1-security/1.11-conditional-access-and-phishing-resistant-mfa.md) | MFA and device compliance for external users |
| [1.5 - DLP and Sensitivity Labels](../pillar-1-security/1.5-data-loss-prevention-dlp-and-sensitivity-labels.md) | DLP can block external sharing of labeled content |
| [4.1 - Information Access Governance](4.1-sharepoint-information-access-governance-iag-restricted-content-discovery.md) | Complements access restrictions with content discovery controls |
| [4.2 - Site Access Reviews](4.2-site-access-reviews-and-certification.md) | Periodic reviews include guest access verification |

---

## Implementation Guides

> For step-by-step implementation, see the playbooks:

- [Portal Walkthrough](../../playbooks/control-implementations/4.4/portal-walkthrough.md) - Step-by-step portal configuration
- [PowerShell Setup](../../playbooks/control-implementations/4.4/powershell-setup.md) - Scripts for automation
- [Verification & Testing](../../playbooks/control-implementations/4.4/verification-testing.md) - Test cases and evidence collection
- [Troubleshooting](../../playbooks/control-implementations/4.4/troubleshooting.md) - Common issues and resolutions

---

## Verification Criteria

Confirm control effectiveness by verifying:

1. Zone 3 sites have external sharing set to "Disabled"
2. Zone 2 sites are restricted to "Existing guests only" or more restrictive
3. Guest access expiration is enabled at 30 days for regulated sites
4. Default link type is set to "Internal" at organization level
5. No unauthorized sharing links exist in Data access governance reports

---

## Additional Resources

- [Manage sharing settings in SharePoint](https://learn.microsoft.com/en-us/sharepoint/turn-external-sharing-on-or-off)
- [External sharing overview](https://learn.microsoft.com/en-us/sharepoint/external-sharing-overview)
- [Guest access expiration](https://learn.microsoft.com/en-us/sharepoint/turn-external-sharing-on-or-off#guest-access-to-a-site-or-onedrive-will-expire-automatically)
- [Data access governance reports](https://learn.microsoft.com/en-us/sharepoint/data-access-governance-reports)

---

*Updated: January 2026 | Version: v1.2 | UI Verification Status: Current*
