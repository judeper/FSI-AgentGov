# Control 3.9: Microsoft Sentinel Integration

**Control ID:** 3.9
**Pillar:** Reporting
**Regulatory Reference:** OCC Heightened Standards, Fed SR 11-7, FINRA 4370, SOX 404
**Last UI Verified:** January 2026
**Governance Levels:** Baseline / Recommended / Regulated

---

## Objective

Integrate AI agent monitoring with Microsoft Sentinel SIEM/XDR capabilities for enterprise-grade security visibility, automated threat detection, and centralized incident response. This control enables proactive security monitoring of agent behavior patterns and rapid response to anomalies.

---

## Why This Matters for FSI

- **OCC Heightened Standards:** Require enhanced monitoring for technology risk
- **Fed SR 11-7:** Model risk management extends to AI agent security
- **FINRA 4370:** Business continuity requires security incident detection
- **SOX 404:** IT controls must include security monitoring
- **Regulatory Expectations:** Centralized SIEM demonstrates security maturity

---

## Control Description

Microsoft Sentinel integration provides advanced security analytics for AI agents through data connectors, custom analytics rules, automated response playbooks, and proactive hunting capabilities.

| Capability | Description |
|------------|-------------|
| **Data Connectors** | Ingest logs from M365, Power Platform, Entra ID |
| **Analytics Rules** | Detect unusual agent behavior patterns |
| **Workbooks** | Visualize agent security posture |
| **Automation** | Respond to threats automatically |
| **Hunting** | Proactive threat investigation |

**Key Detection Scenarios:**

| Scenario | Detection Method | Response |
|----------|------------------|----------|
| Unusual data access | Baseline deviation | Alert + review |
| DLP violation | Policy match | Alert + suspend |
| After-hours activity | Time-based rule | Alert + log |
| Mass data download | Volume threshold | Alert + block |

---

## Key Configuration Points

- Deploy Microsoft Sentinel workspace in dedicated resource group
- Connect data sources: M365 Defender, Entra ID, Office 365, Defender for Cloud Apps
- Create analytics rules for agent anomalies: unusual access, DLP violations, after-hours activity
- Build workbooks for agent activity visualization and security metrics
- Configure automation rules for high-severity alerts (suspend agent, notify security)
- Develop hunting queries for proactive investigation
- Integrate incident management with Control 3.4

---

## Zone-Specific Requirements

| Zone | Requirement | Rationale |
|------|-------------|-----------|
| **Zone 1** (Personal) | Basic logging; monthly review | Low-risk, minimal monitoring |
| **Zone 2** (Team) | Analytics rules; weekly workbook review | Team data exposure |
| **Zone 3** (Enterprise) | Full detection suite; real-time alerting; automated response | Customer-facing, highest security need |

---

## Roles & Responsibilities

| Role | Responsibility |
|------|----------------|
| Entra Security Admin | Sentinel deployment, connector configuration |
| Security Operations | Monitor alerts, investigate incidents |
| AI Governance Lead | Define detection requirements, review workbooks |
| Platform Admin | Ensure log ingestion, workspace health |

---

## Related Controls

| Control | Relationship |
|---------|--------------|
| [1.7 - Audit Logging](../pillar-1-security/1.7-comprehensive-audit-logging-and-compliance.md) | Data source for Sentinel |
| [1.8 - Runtime Protection](../pillar-1-security/1.8-runtime-protection-and-external-threat-detection.md) | Threat signals integration |
| [3.4 - Incident Reporting](3.4-incident-reporting-and-root-cause-analysis.md) | Incident workflow integration |
| [3.7 - Security Posture](3.7-ppac-security-posture-assessment.md) | Complementary security view |

---

## Implementation Guides

> For step-by-step implementation, see the playbooks:

- [Portal Walkthrough](../../playbooks/control-implementations/3.9/portal-walkthrough.md) - Step-by-step portal configuration
- [PowerShell Setup](../../playbooks/control-implementations/3.9/powershell-setup.md) - KQL queries and automation scripts
- [Verification & Testing](../../playbooks/control-implementations/3.9/verification-testing.md) - Test cases and evidence collection
- [Troubleshooting](../../playbooks/control-implementations/3.9/troubleshooting.md) - Common issues and resolutions

---

## Verification Criteria

Confirm control effectiveness by verifying:

1. All required data connectors show "Connected" status with recent data
2. Analytics rules for agent anomalies are enabled and generating alerts
3. Workbook displays agent activity metrics without errors
4. Automation rules execute successfully on test alerts
5. Hunting queries return results from recent agent activity
6. Incidents integrate with incident tracking system (Control 3.4)

---

## Additional Resources

- [What is Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/overview)
- [Microsoft Sentinel Data Connectors](https://learn.microsoft.com/azure/sentinel/connect-data-sources)
- [Create Custom Analytics Rules](https://learn.microsoft.com/azure/sentinel/detect-threats-custom)
- [Microsoft Sentinel Workbooks](https://learn.microsoft.com/azure/sentinel/monitor-your-data)
- [Automation Rules](https://learn.microsoft.com/azure/sentinel/automate-incident-handling-with-automation-rules)

---

*Updated: January 2026 | Version: v1.1 | UI Verification Status: Current*
