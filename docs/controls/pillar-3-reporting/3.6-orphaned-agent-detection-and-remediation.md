# Control 3.6: Orphaned Agent Detection and Remediation

**Control ID:** 3.6
**Pillar:** Reporting
**Regulatory Reference:** FINRA 4511, SOX 404, GLBA 501(b), OCC 2011-12
**Last UI Verified:** January 2026
**Governance Levels:** Baseline / Recommended / Regulated

---

## Objective

Identify and remediate AI agents that lack assigned owners, have been abandoned, or are no longer actively maintained. Orphaned agents represent security, compliance, and operational risks that must be addressed through automated detection and structured remediation workflows.

---

## Why This Matters for FSI

- **FINRA 4511:** Unowned agents may generate records without proper supervision
- **SOX 404:** Orphaned agents bypass IT general controls for access and change management
- **GLBA 501(b):** Unmanaged agents accessing customer data violate safeguard requirements
- **OCC 2011-12:** Third-party risk extends to unmonitored agent deployments
- **Security Risk:** Orphaned agents are prime targets for exploitation

---

## Control Description

This control establishes automated detection of orphaned agents through owner status monitoring, inactivity tracking, and environment health checks. Remediation workflows ensure proper reassignment, archival, or deletion with appropriate approvals.

| Capability | Description |
|------------|-------------|
| **Owner Monitoring** | Detect when agent owner departs or becomes inactive |
| **Activity Tracking** | Flag agents with zero activity for 90+ days |
| **Health Checks** | Identify agents with broken connectors or environments |
| **Remediation Workflow** | Structured process for reassign/archive/delete |
| **SLA Enforcement** | Time-bound remediation with escalation |

**Orphan Categories:**

| Category | Risk Level | Remediation SLA | Description |
|----------|------------|-----------------|-------------|
| Owner Departed | Critical | 14 days | Agent owner left organization |
| Environment Deleted | Critical | 3 days | Underlying environment removed |
| No Activity (90d) | Medium | 30 days | Zero usage for extended period |
| License Expired | High | 7 days | Required license no longer valid |
| Connector Broken | Medium | 14 days | External connection failed |
| **Shadow Agent (Unmanaged)** | Critical | 7 days | Agent exists in tenant but not in registry |

---

## Shadow Agent Detection

Shadow agents are AI agents that exist within the tenant but are not registered in the organization's agent inventory. Unlike orphaned agents (known agents that lose owners), shadow agents represent undiscovered or unmanaged deployments that bypass governance controls entirely.

### Why Shadow Agents Are Critical for FSI

- **Regulatory Gap** - Unregistered agents cannot be included in regulatory reporting or examination responses
- **Data Exposure** - Shadow agents may access customer data without proper DLP controls
- **Audit Failure** - Examiners expect complete agent inventories; shadow agents create material gaps
- **Security Risk** - Unmonitored agents are prime vectors for data exfiltration or abuse

### Discovery Methods

| Method | Coverage | Frequency | Tools |
|--------|----------|-----------|-------|
| **PowerShell Tenant Scan** | Copilot Studio, Power Platform | Weekly | PowerShell, Power Platform Admin Center |
| **Defender for Cloud Apps** | All cloud-connected agents | Continuous | Microsoft Defender XDR |
| **Entra App Registration Audit** | Agents with app registrations | Weekly | Entra ID, Microsoft Graph |
| **M365 Admin Center Review** | Integrated apps, Copilot agents | Weekly | M365 Admin Center |

### Shadow Agent Discovery Process

**Step 1: Enumerate All Agents in Tenant**

Use multiple discovery sources to build a comprehensive list:

```powershell
# Power Platform agents
Get-AdminPowerApp -EnvironmentName $env | Where-Object { $_.Properties.appType -eq "Agent" }

# Copilot Studio agents
Connect-MicrosoftTeams
Get-CsTeamsApp | Where-Object { $_.AppType -eq "Bot" }

# Entra Agentic Users
Get-MgUser -Filter "userType eq 'AgenticUser'" -All
```

**Step 2: Compare Against Agent Registry**

Cross-reference discovered agents against the inventory from Control 3.1:

- Match by Agent ID, App ID, or unique identifier
- Flag any agents not found in the registry as "Shadow Agent"
- Document discovery source and discovery date

**Step 3: Risk Assessment**

For each shadow agent, assess:

| Factor | Questions |
|--------|-----------|
| **Data Access** | What data sources can this agent access? |
| **Owner Identification** | Can we identify who created this agent? |
| **Business Purpose** | Is there a legitimate business need? |
| **Compliance Impact** | Does this affect regulated data or processes? |

**Step 4: Remediation Decision**

| Decision | Criteria | Action |
|----------|----------|--------|
| **Register** | Legitimate business need, identifiable owner | Add to registry with proper metadata |
| **Transfer** | Valid agent, wrong owner/zone | Reassign and register |
| **Decommission** | No business need or owner | Disable and schedule deletion |
| **Escalate** | Accessing sensitive data, unknown origin | Security team review |

### Zone-Specific Shadow Agent Scanning

| Zone | Scan Scope | Frequency | Response |
|------|------------|-----------|----------|
| **Zone 1** | Personal workspace apps | Monthly | Register or decommission |
| **Zone 2** | Team environments, shared agents | Weekly | Register with owner assignment |
| **Zone 3** | All production environments | Daily | Immediate suspension pending review |

### Integration with Agent Inventory (Control 3.1)

Shadow agent detection feeds directly into the agent inventory:

1. **Discovery Feed** - Automated discovery results populate a "Pending Review" queue in the inventory
2. **Reconciliation Report** - Weekly report showing registry vs. tenant discrepancies
3. **Registration Workflow** - Streamlined process to register legitimate shadow agents
4. **Audit Evidence** - Detection logs demonstrate proactive governance for examiners

### Defender for Cloud Apps Integration

Microsoft Defender for Cloud Apps provides continuous shadow agent monitoring:

1. Navigate to **Microsoft Defender XDR** > **Cloud Apps** > **Cloud App Catalog**
2. Filter for AI/ML applications and agents
3. Review **Discovered Apps** for unmanaged agent activity
4. Configure alerts for new agent discoveries
5. Export findings for integration with agent registry

---

## Key Configuration Points

- Define orphan criteria: owner departed, inactive 90+ days, broken connectors, deleted environment
- Create SharePoint orphan tracking list with status, assigned reviewer, and action fields
- Configure Power Automate flow for weekly automated detection against Entra ID
- Establish remediation options: Reassign (transfer to new owner), Archive (disable), Delete (permanent removal)
- Define approval requirements by zone and action type
- Set SLAs for review and remediation with automatic escalation

---

## Zone-Specific Requirements

| Zone | Requirement | Rationale |
|------|-------------|-----------|
| **Zone 1** (Personal) | Monthly detection; team lead approval for deletion | Low risk, simple remediation |
| **Zone 2** (Team) | Weekly detection; manager approval for archive/delete | Team data exposure risk |
| **Zone 3** (Enterprise) | Immediate detection; director + compliance approval; auto-suspend if unresolved | Customer-facing risk, regulatory exposure |

---

## Roles & Responsibilities

| Role | Responsibility |
|------|----------------|
| Power Platform Admin | Run detection, execute remediation actions |
| AI Governance Lead | Review orphan reports, approve sensitive actions |
| Business Unit Owner | Identify replacement owner for reassignment |
| HR Integration | Provide termination/departure notifications |

---

## Related Controls

| Control | Relationship |
|---------|--------------|
| [3.1 - Agent Inventory](3.1-agent-inventory-and-metadata-management.md) | Source of owner and status data |
| [2.3 - Change Management](../pillar-2-management/2.3-change-management-and-release-planning.md) | Retirement workflow for orphans |
| [2.8 - Access Control](../pillar-2-management/2.8-access-control-and-segregation-of-duties.md) | Owner determines access rights |
| [3.5 - Cost Tracking](3.5-cost-allocation-and-budget-tracking.md) | Orphans contribute to wasted spend |

---

## Implementation Guides

> For step-by-step implementation, see the playbooks:

- [Portal Walkthrough](../../playbooks/control-implementations/3.6/portal-walkthrough.md) - Step-by-step portal configuration
- [PowerShell Setup](../../playbooks/control-implementations/3.6/powershell-setup.md) - Scripts for automation
- [Verification & Testing](../../playbooks/control-implementations/3.6/verification-testing.md) - Test cases and evidence collection
- [Troubleshooting](../../playbooks/control-implementations/3.6/troubleshooting.md) - Common issues and resolutions

---

## Verification Criteria

Confirm control effectiveness by verifying:

1. Weekly orphan detection runs without errors and flags all orphan categories
2. Orphan count in M365 Admin Center Agents > Overview matches detection results
3. Remediation SLAs are tracked with automatic escalation at breach
4. Reassignment transfers all permissions and metadata to new owner
5. Archived agents are disabled and inaccessible to users
6. Deletion requires documented approval per zone requirements

---

## Additional Resources

- [Manage Copilot Agents in Integrated Apps](https://learn.microsoft.com/en-us/microsoft-365/admin/manage/manage-copilot-agents-integrated-apps)
- [Power Platform Admin Center Resources](https://learn.microsoft.com/en-us/power-platform/admin/admin-documentation)
- [Entra ID User Management](https://learn.microsoft.com/en-us/entra/identity/users/)
- [Power Automate Scheduled Flows](https://learn.microsoft.com/en-us/power-automate/run-scheduled-tasks)
- [Microsoft Defender for Cloud Apps - Discover and Manage Shadow IT](https://learn.microsoft.com/en-us/defender-cloud-apps/tutorial-shadow-it)
- [Microsoft Learn: Agent 365 Identity (Preview)](https://learn.microsoft.com/en-us/microsoft-agent-365/developer/identity)
- [Microsoft Learn: Agent 365 Observability (Preview)](https://learn.microsoft.com/en-us/microsoft-agent-365/developer/observability)

### Agent ID Lifecycle Governance (Preview)

> **Note:** The following resources are preview documentation and may change.

Microsoft Entra Agent ID provides lifecycle governance capabilities that enhance orphan detection:

- **Sponsorship Model** - Agents require human sponsors; orphan detected when sponsor departs
- **Lifecycle Events** - Automatic notifications when agent identities require attention

- [Microsoft Learn: Governing Agent Identities](https://learn.microsoft.com/en-us/entra/id-governance/agent-id-governance-overview) - Agent lifecycle governance including orphan detection

---

*Updated: January 2026 | Version: v1.2 | UI Verification Status: Current*
