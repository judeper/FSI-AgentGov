# Control 4.7: Microsoft 365 Copilot Data Governance

## Overview

**Control ID:** 4.7
**Control Name:** Microsoft 365 Copilot Data Governance
**Regulatory Reference:** SEC 17a-3/4, GLBA 501(b), FINRA 4511, SOX 302/404, OCC 2011-12
**Setup Time:** 5-7 hours

---

### Purpose

Establish governance controls specific to **Microsoft 365 Copilot** (the embedded AI capabilities in Word, Excel, PowerPoint, Outlook, Teams, and other M365 applications) as distinct from custom agents built in Copilot Studio. This control addresses knowledge source governance, plugin management, user behavior guardrails, and output quality considerations for the M365 Copilot experiences that access organizational data through the Microsoft Graph and Semantic Index.

!!! info "M365 Copilot vs. Copilot Studio"
    This control focuses on the **embedded Copilot experiences** (Copilot in Word, Excel, Teams, etc.) that are available to users with Microsoft 365 Copilot licenses. For custom agent governance, see [Control 4.6 (Grounding Scope Governance)](4.6-grounding-scope-governance.md) and Pillar 2 Management controls. The two require different governance approaches because M365 Copilot accesses broader organizational data automatically, while Copilot Studio agents have explicitly configured knowledge sources.

---

### Description

Microsoft 365 Copilot Data Governance establishes policies and procedures for:

- **Knowledge Source Boundaries:** Control which SharePoint, OneDrive, and Teams data M365 Copilot can access
- **Web and Plugin Access:** Manage external data sources and third-party plugins
- **User Behavior Guardrails:** Policies for appropriate use and over-reliance prevention
- **Output Quality Assurance:** Review processes for Copilot-generated content
- **Access Control:** Ensure Copilot respects existing permissions and doesn't surface overshared content

See [Microsoft 365 Copilot overview](https://learn.microsoft.com/en-us/microsoft-365-copilot/microsoft-365-copilot-overview) for platform details.

---

### Key Capabilities

| Capability | Description | FSI Relevance |
|------------|-------------|---------------|
| **Restricted Content Discovery** | Exclude sensitive sites from Copilot | Data minimization |
| **Plugin Governance** | Control third-party integrations | Vendor risk management |
| **Web Search Control** | Enable/disable web grounding | Information accuracy |
| **Usage Analytics** | Monitor Copilot adoption and usage | Oversight and compliance |
| **Sensitivity Label Respect** | Ensure labels are honored | DLP enforcement |

---

## Prerequisites

**Primary Owner Admin Role:** Microsoft 365 Admin
**Supporting Roles:** SharePoint Admin, Purview Compliance Admin, Power Platform Admin

### Licenses Required

| License | Purpose | Required For |
|---------|---------|--------------|
| Microsoft 365 Copilot | Core Copilot functionality | All users |
| Microsoft 365 E3/E5 | Base platform features | All levels |
| SharePoint Advanced Management | Enhanced site governance | Level 2+ |
| Microsoft Purview | Sensitivity labels, DLP | Level 2+ |

### Permissions Required

| Role | Purpose | Assignment Method |
|------|---------|-------------------|
| Microsoft 365 Admin | Copilot settings management | Entra ID |
| SharePoint Administrator | Site exclusion configuration | Entra ID |
| Compliance Administrator | DLP and sensitivity policies | Purview |
| Global Administrator | Tenant-wide settings | Entra ID |

### Dependencies

| Dependency | Description | Verification |
|------------|-------------|--------------|
| [Control 3.8 (Copilot Hub)](../pillar-3-reporting/3.8-copilot-hub-and-governance-dashboard.md) | Copilot management portal | Verify Hub access |
| [Control 4.6 (Grounding Scope)](4.6-grounding-scope-governance.md) | SharePoint content scoping | Review exclusions |
| [Control 1.5 (DLP/Sensitivity Labels)](../pillar-1-security/1.5-data-loss-prevention-dlp-and-sensitivity-labels.md) | Content classification | Verify labels deployed |
| [Control 4.1 (IAG/RCD)](4.1-sharepoint-information-access-governance-iag-restricted-content-discovery.md) | Restricted Content Discovery | Check RCD configuration |

### Pre-Setup Checklist

- [ ] Microsoft 365 Copilot licenses assigned to target users
- [ ] SharePoint site inventory completed with sensitivity classification
- [ ] Sensitivity labels deployed to organizational content
- [ ] Plugin inventory and risk assessment completed
- [ ] User acceptable use policy drafted
- [ ] Training program developed

---

## Governance Levels

### Baseline (Level 1)

| Requirement | Configuration |
|-------------|---------------|
| License management | Track Copilot license assignments |
| Basic access control | Rely on existing permissions |
| Awareness | User communication about Copilot availability |

**Minimum requirements:**

- Inventory users with M365 Copilot licenses
- Document Copilot deployment scope
- Basic user guidance on appropriate use
- Quarterly usage review

### Recommended (Level 2-3)

| Requirement | Configuration |
|-------------|---------------|
| Content exclusions | Exclude sensitive sites from Copilot |
| Plugin governance | Approve/block third-party plugins |
| Usage monitoring | Regular analytics review |
| Training program | Mandatory Copilot training |

**FSI recommendations:**

- Configure Restricted Content Discovery for sensitive repositories
- Establish plugin approval workflow
- Deploy sensitivity labels to high-risk content
- Monthly usage analytics review
- Annual training refresh for all Copilot users

### Regulated/High-Risk (Level 4)

| Requirement | Configuration |
|-------------|---------------|
| Comprehensive exclusions | Default-deny for unlabeled content |
| Strict plugin control | Allowlist-only plugin model |
| Output review processes | Formal review for external communications |
| Full audit trail | Log all Copilot interactions |

**FSI considerations (high-risk):**

- Explicit content approval for Copilot access
- All plugins require security and compliance review
- Mandatory human review for customer-facing Copilot outputs
- Full audit logging with 6+ year retention
- Quarterly compliance attestation
- Third-party validation of controls

---

## Setup & Configuration

### Step 1: Understand M365 Copilot Data Access

**What M365 Copilot Can Access:**

Microsoft 365 Copilot accesses data through the Microsoft Graph, respecting user permissions:

| Data Source | Default Access | Governance Control |
|-------------|---------------|-------------------|
| **User's OneDrive** | Yes (user's own files) | N/A - personal scope |
| **SharePoint Sites** | Yes (if user has access) | Restricted Content Discovery |
| **Teams Channels** | Yes (if user is member) | Teams governance policies |
| **Outlook Email** | Yes (user's mailbox) | Exchange policies |
| **Microsoft Graph** | Per user permissions | App permissions |
| **Web Search** | Configurable | Admin setting |
| **Plugins** | Configurable | Admin approval |

**Permission Model:**

```
┌──────────────────────────────────────────────────────────────────┐
│                    Microsoft 365 Copilot                          │
│                                                                   │
│   Accesses data based on USER's existing permissions              │
│   + Organizational controls (RCD, DLP, Sensitivity Labels)        │
└───────────────────────────┬──────────────────────────────────────┘
                            │
    ┌───────────────────────┼───────────────────────┐
    │                       │                       │
    ▼                       ▼                       ▼
┌─────────┐           ┌─────────┐           ┌─────────┐
│OneDrive │           │SharePoint│          │ Teams   │
│(Personal)│          │ (Shared) │          │(Channels)│
└─────────┘           └─────────┘           └─────────┘
                            │
                            ▼
                    Restricted Content
                    Discovery (RCD) can
                    exclude sites from
                    Copilot results
```

### Step 2: Configure Copilot Settings in M365 Admin Center

**Portal Path:** Microsoft 365 Admin Center → Settings → Copilot

1. Navigate to **admin.microsoft.com**
2. Go to **Settings** → **Org settings** → **Copilot**
3. Configure the following:

**Copilot General Settings:**

| Setting | Baseline | Recommended | Regulated |
|---------|----------|-------------|-----------|
| **Copilot enabled** | Yes | Yes | Yes |
| **Web search** | Enabled | Review | Disabled |
| **Plugin marketplace** | Enabled | Limited | Disabled |
| **Usage analytics** | Enabled | Enabled | Enabled |

**Web Search Configuration:**

```powershell
# Configure web search for M365 Copilot
# Note: Uses Microsoft 365 admin PowerShell

Connect-MgGraph -Scopes "Organization.ReadWrite.All"

# Disable web search for Copilot (regulated environments)
$params = @{
    WebSearchEnabled = $false
}

# Get current organization settings
$orgSettings = Get-MgOrganization
Write-Host "Current Copilot web search status requires M365 Admin Center configuration"
```

### Step 3: Configure Content Exclusions (Restricted Content Discovery)

**Exclude Sensitive Sites from M365 Copilot:**

Per [Control 4.6](4.6-grounding-scope-governance.md) and [Control 4.1](4.1-sharepoint-information-access-governance-iag-restricted-content-discovery.md):

**Portal Path:** SharePoint Admin Center → Sites → Active sites → [Site] → Settings

```powershell
# Exclude site from M365 Copilot via Restricted Content Discovery
Connect-SPOService -Url "https://tenant-admin.sharepoint.com"

# Exclude sensitive sites from Copilot (and org-wide search)
$sensitiveSites = @(
    "https://tenant.sharepoint.com/sites/ExecutiveCompensation",
    "https://tenant.sharepoint.com/sites/MergerTarget",
    "https://tenant.sharepoint.com/sites/LegalHold",
    "https://tenant.sharepoint.com/sites/ComplianceInvestigations"
)

foreach ($siteUrl in $sensitiveSites) {
    Set-SPOSite -Identity $siteUrl -RestrictContentOrgWideSearchAndCopilot $true
    Write-Host "Excluded from Copilot: $siteUrl" -ForegroundColor Yellow
}

# Verify exclusions
foreach ($siteUrl in $sensitiveSites) {
    $site = Get-SPOSite -Identity $siteUrl
    Write-Host "$siteUrl - RCD Enabled: $($site.RestrictContentOrgWideSearchAndCopilot)"
}
```

**Categories to Consider for Exclusion:**

| Content Category | Risk Level | Recommendation |
|-----------------|------------|----------------|
| **Executive compensation** | High | Exclude |
| **M&A / Deal rooms** | Critical | Exclude |
| **Legal/Compliance investigations** | Critical | Exclude |
| **HR confidential** | High | Exclude |
| **Board materials** | High | Exclude |
| **Draft content** | Medium | Consider exclusion |
| **Personal OneDrive** | Low | User-controlled |
| **General knowledge bases** | Low | Include |

### Step 4: Configure Plugin Governance

**Portal Path:** Microsoft 365 Admin Center → Settings → Integrated apps

**Plugin Risk Assessment Framework:**

| Risk Factor | Low Risk | Medium Risk | High Risk |
|-------------|----------|-------------|-----------|
| **Data access** | Read-only, public data | Read org data | Read/write sensitive data |
| **Vendor** | Microsoft first-party | Established vendor | Unknown/new vendor |
| **Certification** | M365 certified | SOC 2 | No certification |
| **Data residency** | Same region | Multi-region | Unknown |

**Plugin Approval Workflow:**

```yaml
# Plugin approval workflow configuration
plugin_governance:
  approval_required: true

  approval_workflow:
    requestor_submits:
      - plugin_name
      - business_justification
      - data_access_scope
      - vendor_information

    review_chain:
      level_1: "IT Security"
      level_2: "Compliance"
      level_3: "AI Governance Lead"  # For Zone 2+ use cases

  plugin_categories:
    approved_by_default:
      - "Microsoft Graph connectors"
      - "Microsoft first-party plugins"

    requires_approval:
      - "Third-party productivity tools"
      - "Data connectors"
      - "Custom plugins"

    blocked:
      - "Uncertified plugins"
      - "Plugins without privacy policy"
      - "Plugins storing data outside approved regions"

  review_criteria:
    - "Does the plugin access sensitive data categories?"
    - "Is the vendor SOC 2 certified?"
    - "Where is data processed and stored?"
    - "What audit logging does the plugin provide?"
    - "Is there a data processing agreement in place?"
```

**PowerShell: Review Installed Plugins**

```powershell
# List integrated apps and plugins
Connect-MgGraph -Scopes "Application.Read.All", "Organization.Read.All"

# Get all service principals (includes integrated apps)
$apps = Get-MgServicePrincipal -Filter "tags/any(t:t eq 'WindowsAzureActiveDirectoryIntegratedApp')" -All

$appInventory = $apps | ForEach-Object {
    [PSCustomObject]@{
        DisplayName = $_.DisplayName
        AppId = $_.AppId
        Publisher = $_.PublisherName
        SignInAudience = $_.SignInAudience
        Tags = ($_.Tags -join ", ")
        CreatedDate = $_.CreatedDateTime
    }
}

$appInventory | Export-Csv -Path "M365-Integrated-Apps.csv" -NoTypeInformation
Write-Host "Exported $($appInventory.Count) integrated apps"
```

### Step 5: Establish User Behavior Guardrails

**Acceptable Use Policy for M365 Copilot:**

```markdown
# Microsoft 365 Copilot Acceptable Use Policy

## Purpose
This policy establishes guidelines for the appropriate use of Microsoft 365
Copilot features within [Organization Name].

## Scope
This policy applies to all employees with Microsoft 365 Copilot licenses.

## Acceptable Uses
- Drafting internal documents and communications
- Summarizing meeting notes and email threads
- Data analysis and visualization assistance
- Research and information gathering from organizational sources
- Productivity assistance in M365 applications

## Restrictions

### Content Review Requirements
- **Customer-facing communications:** Must be reviewed by a human before sending
- **Financial reports:** Copilot outputs must be verified against source data
- **Legal documents:** Require legal review before use
- **Regulatory filings:** Must follow existing review/approval processes

### Prohibited Uses
- Generating content for regulatory filings without human review
- Making investment recommendations based solely on Copilot output
- Sharing Copilot outputs externally without review
- Using Copilot to access data you shouldn't have access to
- Relying on Copilot for calculations in official documents

### Data Handling
- Do not input confidential client information into Copilot prompts unnecessarily
- Do not attempt to use Copilot to access restricted content
- Report any instances where Copilot surfaces inappropriate content

## Over-Reliance Prevention
- Copilot is an assistant, not a decision-maker
- Always verify factual claims and calculations
- Use professional judgment for all final outputs
- Document when Copilot was used in creating materials (if required by policy)

## Reporting
Report concerns about Copilot behavior to:
- IT Help Desk (technical issues)
- Compliance (content concerns)
- AI Governance Lead (policy questions)

## Consequences
Violations of this policy may result in:
- Removal of Copilot license
- Disciplinary action per HR policy
- Mandatory retraining
```

### Step 6: Configure Output Review Processes

**Review Requirements by Output Type:**

| Output Type | Internal Use | External Use | Regulatory Use |
|-------------|--------------|--------------|----------------|
| **Email draft** | Self-review | Manager review | Compliance review |
| **Document draft** | Self-review | Peer review | Formal approval |
| **Presentation** | Self-review | Stakeholder review | Compliance review |
| **Data analysis** | Verify calculations | Verify + peer review | Independent verification |
| **Summary/recap** | Self-review | Verify accuracy | Formal documentation |

**Copilot Output Review Checklist:**

```markdown
# Copilot Output Review Checklist

## Before Using Copilot Output

### Factual Accuracy
- [ ] Verified key facts against source documents
- [ ] Checked numerical calculations manually
- [ ] Confirmed dates and figures are current
- [ ] Validated any regulatory references

### Appropriateness
- [ ] Content is appropriate for intended audience
- [ ] Tone matches organizational standards
- [ ] No confidential information exposed inappropriately
- [ ] Disclaimers added where required

### Compliance
- [ ] Output complies with applicable regulations
- [ ] No unauthorized recommendations or advice
- [ ] Disclosures included where required
- [ ] Retention requirements considered

### Attribution
- [ ] Source materials properly cited
- [ ] Copilot assistance disclosed if required by policy
- [ ] No plagiarism or IP concerns

## Sign-Off
- [ ] I have reviewed this Copilot-assisted output and take responsibility for its accuracy and appropriateness.

Reviewer: _________________ Date: _________
```

### Step 7: Configure Usage Monitoring

**Portal Path:** Microsoft 365 Admin Center → Reports → Usage → Microsoft 365 Copilot usage

**Key Metrics to Track:**

| Metric | Purpose | Review Frequency |
|--------|---------|------------------|
| **Active users** | Adoption tracking | Weekly |
| **Feature usage** | Understand patterns | Monthly |
| **Queries per user** | Identify heavy users | Monthly |
| **App distribution** | Which apps used most | Monthly |
| **Feedback submitted** | Quality signal | Weekly |

**PowerShell: Usage Analytics**

```powershell
# Get Copilot usage report
Connect-MgGraph -Scopes "Reports.Read.All"

# Get Copilot usage data
$reportPeriod = "D30"  # Last 30 days

# Note: Specific report endpoints depend on available Graph APIs
# Check Microsoft Learn for current Copilot reporting APIs

Write-Host "Copilot usage reports available in M365 Admin Center" -ForegroundColor Cyan
Write-Host "Navigate to: admin.microsoft.com > Reports > Usage > Microsoft 365 Copilot usage"
```

**Copilot Usage Dashboard (Power BI):**

```kql
// Copilot usage summary by application
CopilotInteraction
| where TimeGenerated > ago(30d)
| summarize
    TotalInteractions = count(),
    UniqueUsers = dcount(UserId),
    AvgInteractionsPerUser = round(1.0 * count() / dcount(UserId), 2)
    by ApplicationName
| order by TotalInteractions desc
```

---

### PowerShell Configuration

### M365 Copilot Governance Audit Script

```powershell
# ============================================================
# Control 4.7: Microsoft 365 Copilot Data Governance
# Comprehensive Governance Audit Script
# ============================================================

param(
    [string]$TenantAdminUrl = "https://tenant-admin.sharepoint.com",
    [string]$OutputPath = ".\M365-Copilot-Audit-$(Get-Date -Format 'yyyyMMdd')"
)

New-Item -ItemType Directory -Path $OutputPath -Force | Out-Null

Write-Host "=== Microsoft 365 Copilot Governance Audit ===" -ForegroundColor Cyan

# ============================================================
# SECTION 1: License Inventory
# ============================================================

Write-Host "`nSection 1: Inventorying Copilot licenses..." -ForegroundColor Yellow

Connect-MgGraph -Scopes "User.Read.All", "Organization.Read.All"

# Get users with Copilot licenses
$copilotSkuPartNumber = "Microsoft_365_Copilot"  # Adjust based on actual SKU

try {
    $licensedUsers = Get-MgUser -Filter "assignedLicenses/any()" -All |
        Where-Object {
            $_.AssignedLicenses | Where-Object {
                $_.SkuId -match "copilot" -or $_.SkuId -match "Copilot"
            }
        }

    Write-Host "Found $($licensedUsers.Count) users with potential Copilot licenses"
    Write-Host "(Note: Verify SKU IDs match your tenant's Copilot license)"
}
catch {
    Write-Host "License inventory requires additional permissions" -ForegroundColor Yellow
}

# ============================================================
# SECTION 2: Content Exclusion Audit
# ============================================================

Write-Host "`nSection 2: Auditing content exclusions..." -ForegroundColor Yellow

Connect-SPOService -Url $TenantAdminUrl

$allSites = Get-SPOSite -Limit All | Where-Object { $_.Template -notlike "*SPSPERS*" }

$siteAudit = $allSites | ForEach-Object {
    [PSCustomObject]@{
        Url = $_.Url
        Title = $_.Title
        RestrictedFromCopilot = $_.RestrictContentOrgWideSearchAndCopilot
        SensitivityLabel = $_.SensitivityLabel
        StorageUsedGB = [math]::Round($_.StorageUsageCurrent / 1024, 2)
        LastModified = $_.LastContentModifiedDate
    }
}

$siteAudit | Export-Csv -Path "$OutputPath\Site-Copilot-Status.csv" -NoTypeInformation

$excludedCount = ($siteAudit | Where-Object { $_.RestrictedFromCopilot -eq $true }).Count
$includedCount = ($siteAudit | Where-Object { $_.RestrictedFromCopilot -eq $false }).Count

Write-Host "Sites excluded from Copilot: $excludedCount"
Write-Host "Sites accessible by Copilot: $includedCount"

# ============================================================
# SECTION 3: Plugin/Integrated Apps Audit
# ============================================================

Write-Host "`nSection 3: Auditing integrated apps..." -ForegroundColor Yellow

try {
    $apps = Get-MgServicePrincipal -All |
        Where-Object { $_.Tags -contains "WindowsAzureActiveDirectoryIntegratedApp" }

    $appAudit = $apps | ForEach-Object {
        [PSCustomObject]@{
            DisplayName = $_.DisplayName
            Publisher = $_.PublisherName
            AppId = $_.AppId
            CreatedDate = $_.CreatedDateTime
            SignInAudience = $_.SignInAudience
        }
    }

    $appAudit | Export-Csv -Path "$OutputPath\Integrated-Apps.csv" -NoTypeInformation
    Write-Host "Found $($appAudit.Count) integrated apps"
}
catch {
    Write-Host "App audit requires Application.Read.All permission" -ForegroundColor Yellow
}

# ============================================================
# SECTION 4: Governance Recommendations
# ============================================================

Write-Host "`nSection 4: Generating recommendations..." -ForegroundColor Yellow

$recommendations = @()

# Check for sensitive sites not excluded
$sensitivePatterns = @("executive", "legal", "hr", "confidential", "board", "merger", "acquisition")
$potentialSensitive = $siteAudit | Where-Object {
    $url = $_.Url.ToLower()
    $title = $_.Title.ToLower()
    $sensitivePatterns | Where-Object { $url -like "*$_*" -or $title -like "*$_*" }
} | Where-Object { $_.RestrictedFromCopilot -ne $true }

if ($potentialSensitive.Count -gt 0) {
    $recommendations += [PSCustomObject]@{
        Category = "Content Exclusion"
        Finding = "$($potentialSensitive.Count) potentially sensitive sites not excluded from Copilot"
        Recommendation = "Review and consider excluding sites matching sensitive patterns"
        Priority = "High"
        Sites = ($potentialSensitive.Url -join "; ")
    }
}

# Check for unlabeled large sites
$unlabeledLarge = $siteAudit | Where-Object {
    $_.StorageUsedGB -gt 10 -and [string]::IsNullOrEmpty($_.SensitivityLabel)
}

if ($unlabeledLarge.Count -gt 0) {
    $recommendations += [PSCustomObject]@{
        Category = "Classification"
        Finding = "$($unlabeledLarge.Count) large sites lack sensitivity labels"
        Recommendation = "Apply sensitivity labels for governance visibility"
        Priority = "Medium"
        Sites = ($unlabeledLarge.Url -join "; ")
    }
}

$recommendations | Export-Csv -Path "$OutputPath\Recommendations.csv" -NoTypeInformation
Write-Host "Generated $($recommendations.Count) recommendations"

# ============================================================
# SECTION 5: Generate HTML Report
# ============================================================

Write-Host "`nSection 5: Generating HTML report..." -ForegroundColor Yellow

$html = @"
<!DOCTYPE html>
<html>
<head>
    <title>M365 Copilot Governance Audit</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; margin: 40px; }
        h1 { color: #0078d4; }
        h2 { color: #333; border-bottom: 2px solid #0078d4; padding-bottom: 5px; }
        .dashboard { display: flex; gap: 20px; flex-wrap: wrap; margin: 20px 0; }
        .card { padding: 20px; background: #f5f5f5; border-radius: 8px; min-width: 150px; }
        .card.success { background: #dff6dd; }
        .card.warning { background: #fff4ce; }
        .card.danger { background: #fde7e9; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { padding: 10px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background: #0078d4; color: white; }
    </style>
</head>
<body>
    <h1>Microsoft 365 Copilot Governance Audit</h1>
    <p>Control 4.7 | Generated: $(Get-Date -Format "yyyy-MM-dd HH:mm:ss")</p>

    <h2>Summary</h2>
    <div class="dashboard">
        <div class="card"><h3>Total Sites</h3><p style="font-size:28px;">$($siteAudit.Count)</p></div>
        <div class="card success"><h3>Excluded from Copilot</h3><p style="font-size:28px;">$excludedCount</p></div>
        <div class="card"><h3>Accessible by Copilot</h3><p style="font-size:28px;">$includedCount</p></div>
        <div class="card $(if ($potentialSensitive.Count -gt 0) { 'warning' })">
            <h3>Potential Sensitive</h3><p style="font-size:28px;">$($potentialSensitive.Count)</p>
        </div>
    </div>

    <h2>Recommendations</h2>
    $(if ($recommendations.Count -gt 0) {
        "<table><tr><th>Category</th><th>Finding</th><th>Recommendation</th><th>Priority</th></tr>"
        $recommendations | ForEach-Object {
            "<tr><td>$($_.Category)</td><td>$($_.Finding)</td><td>$($_.Recommendation)</td><td>$($_.Priority)</td></tr>"
        }
        "</table>"
    } else {
        "<p style='color:green;'>No recommendations - M365 Copilot governance looks healthy!</p>"
    })

    <h2>Governance Checklist</h2>
    <ul>
        <li>Review sensitive site exclusions</li>
        <li>Audit plugin/integrated app inventory</li>
        <li>Verify acceptable use policy is published</li>
        <li>Configure usage monitoring dashboards</li>
        <li>Schedule quarterly governance reviews</li>
    </ul>

    <h2>Output Files</h2>
    <ul>
        <li>Site-Copilot-Status.csv - All sites with Copilot access status</li>
        <li>Integrated-Apps.csv - Plugin and app inventory</li>
        <li>Recommendations.csv - Governance recommendations</li>
    </ul>
</body>
</html>
"@

$html | Out-File -FilePath "$OutputPath\M365-Copilot-Audit-Report.html" -Encoding UTF8
Write-Host "Report generated: $OutputPath\M365-Copilot-Audit-Report.html" -ForegroundColor Green

Write-Host "`n=== Audit Complete ===" -ForegroundColor Cyan
Write-Host "Output files in: $OutputPath" -ForegroundColor Cyan
```

---

## Financial Sector Considerations

### Regulatory Alignment

| Regulation | Requirement | How This Control Helps |
|------------|-------------|------------------------|
| **SEC 17a-3/4** | Record keeping for AI-assisted communications | Usage logging and retention |
| **GLBA 501(b)** | Information safeguards | Content exclusions and access controls |
| **FINRA 4511** | Books and records | Audit trail of Copilot usage |
| **SOX 302/404** | Internal controls | Output review processes |
| **OCC 2011-12** | Model risk management | Over-reliance prevention |
| **FINRA 3110** | Supervision | Review requirements for outputs |

### Zone-Specific Configuration

**Zone 1 (Personal Productivity):**

- Standard M365 Copilot access for individual productivity
- Self-review of outputs
- Basic acceptable use guidance
- Rationale: Personal productivity use is lower risk

**Zone 2 (Team Collaboration):**

- Configure RCD for sensitive team sites
- Peer review for shared outputs
- Plugin approval for team-specific integrations
- Monthly usage review
- Rationale: Shared outputs require more oversight

**Zone 3 (Enterprise Managed):**

- Comprehensive content exclusions
- Strict plugin allowlist
- Mandatory review for external communications
- Full audit logging
- Quarterly compliance attestation
- Rationale: Enterprise-wide Copilot use requires strictest governance

### M365 Copilot vs. Copilot Studio Comparison

| Aspect | M365 Copilot | Copilot Studio Agents |
|--------|--------------|----------------------|
| **Data access** | User's accessible Graph data | Explicitly configured sources |
| **Scope** | All M365 apps (Word, Excel, etc.) | Custom agent scenarios |
| **Control granularity** | Tenant/site level | Per-agent configuration |
| **Plugin management** | Admin Center | Per-agent connectors |
| **Primary control** | This control (4.7) | Controls 2.x, 4.6 |
| **User interaction** | Embedded in M365 apps | Custom chat interfaces |

### FSI Configuration Example

```yaml
# FSI M365 Copilot Governance Configuration
m365_copilot_governance:
  organization: "Regional Bank"
  control_id: "4.7"

  tenant_settings:
    web_search: false  # Disabled for regulated environment
    plugin_marketplace: "restricted"  # Allowlist only

  content_exclusions:
    mandatory_exclude:
      - "*/ExecutiveCompensation"
      - "*/LegalHold/*"
      - "*/ComplianceInvestigations"
      - "*/BoardMaterials"
      - "*/MergerAcquisition/*"
    pattern_exclude:
      - "*confidential*"
      - "*restricted*"
      - "*draft*"

  plugin_governance:
    approved_publishers:
      - "Microsoft Corporation"
    require_soc2: true
    require_compliance_review: true

  output_review:
    customer_communications: "mandatory"
    regulatory_filings: "mandatory"
    internal_documents: "self_review"
    data_analysis: "verify_calculations"

  user_guardrails:
    acceptable_use_policy: "published"
    training_required: true
    training_refresh: "annual"
    over_reliance_warnings: true

  monitoring:
    usage_review: "monthly"
    compliance_attestation: "quarterly"
    audit_retention_years: 7
```

---

## Verification & Testing

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | Access M365 Copilot in Word/Excel | Copilot functional for licensed user |
| 2 | Query for excluded site content | Content not returned |
| 3 | Attempt to use blocked plugin | Plugin not available |
| 4 | Review usage analytics | Data visible in Admin Center |
| 5 | Verify sensitivity labels honored | Labeled content appropriately restricted |
| 6 | Test audit logging | Copilot interactions logged |

### Compliance Checklist

- [ ] Copilot licenses inventoried and tracked
- [ ] Sensitive sites excluded via RCD
- [ ] Plugin governance established (approval workflow)
- [ ] Web search configured per policy
- [ ] Acceptable use policy published
- [ ] Training program deployed
- [ ] Output review processes documented
- [ ] Usage monitoring configured
- [ ] Quarterly review schedule established
- [ ] Audit retention configured (6+ years)

---

## Troubleshooting & Validation

<a id="troubleshooting"></a>

### Issue: Copilot Returning Content from Excluded Site

**Symptoms:** User sees content from site with RCD enabled

**Resolution:**

1. Verify RCD setting on the site (Get-SPOSite)
2. Allow 24 hours for index propagation
3. Check if content exists in multiple locations
4. Verify user doesn't have direct access bypassing RCD
5. Contact Microsoft support if persistent

### Issue: Plugin Not Available After Approval

**Symptoms:** Approved plugin not appearing for users

**Resolution:**

1. Verify plugin is enabled in Admin Center
2. Check user has required license
3. Verify plugin assignment (all users vs. specific groups)
4. Clear browser cache and retry
5. Check for conditional access policies blocking plugin

### Issue: Usage Analytics Not Showing Data

**Symptoms:** Copilot usage reports empty or incomplete

**Resolution:**

1. Verify users have M365 Copilot licenses
2. Allow 48-72 hours for data population
3. Check reporting permissions for admin account
4. Verify no data export restrictions
5. Review Microsoft 365 service health

### Issue: Sensitivity Labels Not Respected

**Symptoms:** Copilot surfaces content despite sensitivity labels

**Resolution:**

1. Verify label includes Copilot restrictions
2. Check label policy assignment to users
3. Verify label is applied to content (not just site)
4. Review DLP policy enforcement
5. Contact Purview support if needed

---

## Additional Resources

<a id="microsoft-learn-references"></a>

- [Microsoft 365 Copilot overview](https://learn.microsoft.com/en-us/microsoft-365-copilot/microsoft-365-copilot-overview)
- [Microsoft 365 Copilot data, privacy, and security](https://learn.microsoft.com/en-us/microsoft-365-copilot/microsoft-365-copilot-privacy)
- [Manage Microsoft 365 Copilot](https://learn.microsoft.com/en-us/microsoft-365-copilot/microsoft-365-copilot-enable-users)
- [Restricted Content Discovery](https://learn.microsoft.com/en-us/sharepoint/restricted-content-discovery)
- [Control 3.8: Copilot Hub](../pillar-3-reporting/3.8-copilot-hub-and-governance-dashboard.md)

---

## Related Controls

| Control | Relationship |
|---------|-------------|
| [3.8 - Copilot Hub](../pillar-3-reporting/3.8-copilot-hub-and-governance-dashboard.md) | M365 Admin Center Copilot management |
| [4.6 - Grounding Scope Governance](4.6-grounding-scope-governance.md) | SharePoint content scoping (for Studio agents) |
| [4.1 - SharePoint IAG/RCD](4.1-sharepoint-information-access-governance-iag-restricted-content-discovery.md) | Restricted Content Discovery configuration |
| [1.5 - DLP/Sensitivity Labels](../pillar-1-security/1.5-data-loss-prevention-dlp-and-sensitivity-labels.md) | Content classification and protection |
| [2.14 - Training and Awareness](../pillar-2-management/2.14-training-and-awareness-program.md) | User training on Copilot |

---

## Support & Questions

For implementation support or questions about this control, contact:

- **Microsoft 365 Admin:** Copilot settings and license management
- **SharePoint Admin:** Content exclusion configuration
- **Compliance Officer:** Acceptable use policy and review requirements
- **AI Governance Lead:** Overall M365 Copilot governance strategy

---

**Updated:** Jan 2026
**Version:** v1.0 (Jan 2026)
**UI Verification Status:** ❌ Needs verification
