# Control 4.6: Grounding Scope Governance

## Overview

**Control ID:** 4.6
**Control Name:** Grounding Scope Governance
**Regulatory Reference:** SEC 17a-3/4, GLBA 501(b), FINRA 4511, SOX 302/404
**Setup Time:** 2-3 hours

---

### Purpose

Govern which SharePoint content is included in the Microsoft 365 Semantic Index for AI agent grounding. This control ensures that agents only access appropriate, authorized content and prevents inadvertent exposure of draft documents, archived materials, personal files, or content not intended for AI consumption. Proper grounding scope governance is essential for maintaining data accuracy, regulatory compliance, and preventing AI agents from surfacing inappropriate information.

!!! info "Semantic Index Overview"
    The Microsoft 365 Semantic Index enables Microsoft 365 Copilot and agents to understand and retrieve organizational content. By default, the index may include content that users can access but shouldn't be surfaced by AI agents. This control establishes governance over what content enters the index.

---

### Description

Grounding Scope Governance establishes policies and procedures to control which SharePoint content is indexed and available for AI agent grounding. Key capabilities include:

- **Site-Level Exclusion:** Exclude entire SharePoint sites from the Semantic Index
- **Content Type Filtering:** Exclude Draft, Archived, or Personal content categories
- **Metadata-Based Rules:** Use site metadata to control index inclusion
- **Graph API Filters:** Configure API-level content exclusion
- **Audit and Monitoring:** Track what content is indexed and accessed

See [Microsoft 365 Copilot data, privacy, and security](https://learn.microsoft.com/en-us/microsoft-365-copilot/microsoft-365-copilot-privacy) for platform details.

---

### Key Capabilities

| Capability | Description | FSI Relevance |
|------------|-------------|---------------|
| **Site Exclusion** | Exclude sites from Semantic Index | Protect sensitive repositories |
| **Restricted Content Discovery** | Limit AI access to specific sites | Data minimization |
| **Metadata Tagging** | Mark content as "Copilot Ready" | Content quality control |
| **Content Type Filtering** | Exclude drafts, archives, personal | Accuracy and compliance |
| **Audit Logging** | Track indexed content and access | Regulatory evidence |

---

## Prerequisites

**Primary Owner Admin Role:** SharePoint Admin
**Supporting Roles:** Power Platform Admin, Purview Compliance Admin

### Licenses Required

| License | Purpose | Required For |
|---------|---------|--------------|
| Microsoft 365 E3/E5 | SharePoint Advanced Management | All levels |
| SharePoint Advanced Management | Enhanced governance features | Level 2+ |
| Microsoft 365 Copilot | Semantic Index access | All agents |
| Microsoft Purview | Sensitivity labels integration | Level 4 |

### Permissions Required

| Role | Purpose | Assignment Method |
|------|---------|-------------------|
| SharePoint Administrator | Configure site exclusions | Entra ID |
| Global Administrator | Tenant-level settings | Entra ID |
| Site Collection Administrator | Site-level configuration | SharePoint |
| Compliance Administrator | Label and policy integration | Purview |

### Dependencies

| Dependency | Description | Verification |
|------------|-------------|--------------|
| Control 4.1 (IAG/RCD) | Site-level access governance | Verify IAG is configured |
| Control 1.5 (DLP/Sensitivity Labels) | Content classification | Check label deployment |
| Control 1.14 (Data Minimization) | Scope control principles | Review data policies |
| Control 4.2 (Site Access Reviews) | Access certification | Confirm review process |

### Pre-Setup Checklist

- [ ] SharePoint Advanced Management license assigned
- [ ] Site inventory completed with content classification
- [ ] Draft/Archive content locations identified
- [ ] Personal site policy defined
- [ ] Sensitivity labels deployed (if using label-based exclusion)
- [ ] Agent inventory linked to knowledge sources

---

## Governance Levels

### Baseline (Level 1)

| Requirement | Configuration |
|-------------|---------------|
| Site awareness | Document which sites agents access |
| Manual exclusion | Exclude known sensitive sites |
| Basic monitoring | Quarterly review of indexed content |

**Minimum requirements:**

- Inventory sites used as agent knowledge sources
- Manually exclude highly sensitive repositories
- Document grounding scope decisions
- Quarterly review of agent data access

### Recommended (Level 2-3)

| Requirement | Configuration |
|-------------|---------------|
| Systematic exclusion | Policy-based site exclusion |
| Content type filtering | Exclude Draft, Archived, Personal |
| Metadata approach | "CopilotReady" tag for approved content |
| Monthly review | Regular audit of indexed content |

**FSI recommendations:**

- Configure Restricted Content Discovery (Control 4.1) for agent sites
- Implement "CopilotReady" metadata approach
- Exclude all personal OneDrive content from agent grounding
- Monthly review of grounding scope compliance

### Regulated/High-Risk (Level 4)

| Requirement | Configuration |
|-------------|---------------|
| Comprehensive governance | All content explicitly approved for indexing |
| Label integration | Sensitivity labels control index inclusion |
| Real-time monitoring | Continuous audit of indexed content |
| Formal approval | Change control for grounding scope changes |

**FSI considerations (high-risk):**

- Require explicit approval for content in Semantic Index
- Use sensitivity labels to control indexing
- Implement real-time monitoring of index changes
- Change control process for grounding scope modifications
- Quarterly compliance attestation from business owners

---

## Setup & Configuration

### Step 1: Inventory Current Grounding Scope

**Identify Content Currently in Semantic Index:**

1. **List all SharePoint sites:**
   ```powershell
   Connect-SPOService -Url "https://tenant-admin.sharepoint.com"
   $sites = Get-SPOSite -Limit All | Where-Object { $_.Template -notlike "*SPSPERS*" }
   $sites | Export-Csv -Path "SharePoint-Sites-Inventory.csv" -NoTypeInformation
   ```

2. **Categorize sites by content type:**

   | Category | Description | Default Index Status | Recommendation |
   |----------|-------------|---------------------|----------------|
   | **Production Knowledge** | Finalized, approved content | Include | Keep indexed |
   | **Draft/WIP** | Work in progress documents | Include (by default) | Exclude |
   | **Archive** | Historical, outdated content | Include (by default) | Exclude |
   | **Personal** | Individual user files | Include (by default) | Exclude |
   | **Regulatory Hold** | Content under legal hold | Include (by default) | Review |
   | **Highly Confidential** | Top-secret business data | Include (by default) | Exclude or restrict |

3. **Document agent knowledge sources:**

   | Agent Name | Agent ID | Knowledge Source Sites | Grounding Scope Status |
   |------------|----------|----------------------|----------------------|
   | [Agent 1] | [ID] | site1.sharepoint.com | Approved |
   | [Agent 2] | [ID] | site2.sharepoint.com, site3.sharepoint.com | Pending Review |

### Step 2: Configure Site Exclusion from Semantic Index

**Portal Path:** SharePoint Admin Center → Sites → Active Sites → [Site] → Settings

**Option A: Restricted Content Discovery (RCD)**

Per Control 4.1, configure RCD to limit which sites are discoverable:

1. Navigate to **SharePoint Admin Center**
2. Go to **Sites** → **Active sites**
3. Select site to exclude
4. Click **Settings** (gear icon)
5. Under **Microsoft 365 Copilot**, configure access:
   - **Standard:** Content indexed and available to Copilot
   - **Restricted:** Content not included in Copilot results

**Option B: Site-Level Exclusion via PowerShell**

```powershell
# Connect to SharePoint Online
Connect-SPOService -Url "https://tenant-admin.sharepoint.com"

# Exclude specific site from Semantic Index
# Note: Uses Restricted Content Discovery capability
Set-SPOSite -Identity "https://tenant.sharepoint.com/sites/DraftDocuments" `
    -RestrictContentOrgWideSearchAndCopilot $true

# Verify configuration
Get-SPOSite -Identity "https://tenant.sharepoint.com/sites/DraftDocuments" |
    Select-Object Url, RestrictContentOrgWideSearchAndCopilot
```

### Step 3: Implement Content Type Exclusion Strategy

**Exclude Draft Content:**

1. **Identify draft content locations:**
   - Sites with "Draft" in name or metadata
   - Libraries with draft workflow status
   - Content with "Draft" content type

2. **Configure exclusion:**
   ```powershell
   # Exclude all sites with "Draft" in URL
   $draftSites = Get-SPOSite -Limit All | Where-Object { $_.Url -like "*draft*" }
   foreach ($site in $draftSites) {
       Set-SPOSite -Identity $site.Url -RestrictContentOrgWideSearchAndCopilot $true
       Write-Host "Excluded: $($site.Url)"
   }
   ```

**Exclude Archived Content:**

```powershell
# Exclude archive sites
$archiveSites = Get-SPOSite -Limit All | Where-Object {
    $_.Url -like "*archive*" -or $_.Title -like "*Archive*"
}
foreach ($site in $archiveSites) {
    Set-SPOSite -Identity $site.Url -RestrictContentOrgWideSearchAndCopilot $true
    Write-Host "Excluded archive: $($site.Url)"
}
```

**Exclude Personal Sites (OneDrive):**

```powershell
# Note: OneDrive personal sites are typically not included in agent grounding by default
# Verify configuration
$personalSites = Get-SPOSite -Template "SPSPERS#10" -Limit All
Write-Host "Personal sites count: $($personalSites.Count)"
Write-Host "Personal sites are excluded from organizational Copilot by default"
```

### Step 4: Implement CopilotReady Metadata Approach

**Create "CopilotReady" Site Property:**

For positive governance (explicitly approve content for indexing):

```powershell
# Add custom property to indicate site is approved for Copilot grounding
# Note: This is a governance marker - actual exclusion still uses RCD

function Set-CopilotReadyStatus {
    param(
        [string]$SiteUrl,
        [bool]$IsReady,
        [string]$ApprovedBy,
        [datetime]$ApprovedDate
    )

    Connect-PnPOnline -Url $SiteUrl -Interactive

    # Set site property bag
    Set-PnPPropertyBagValue -Key "CopilotReady" -Value $IsReady.ToString()
    Set-PnPPropertyBagValue -Key "CopilotReadyApprovedBy" -Value $ApprovedBy
    Set-PnPPropertyBagValue -Key "CopilotReadyApprovedDate" -Value $ApprovedDate.ToString("yyyy-MM-dd")

    Write-Host "Site $SiteUrl marked as CopilotReady: $IsReady"
}

# Mark site as approved for Copilot
Set-CopilotReadyStatus -SiteUrl "https://tenant.sharepoint.com/sites/ProductKnowledge" `
    -IsReady $true -ApprovedBy "compliance@contoso.com" -ApprovedDate (Get-Date)
```

**Query CopilotReady Sites:**

```powershell
function Get-CopilotReadySites {
    param([string]$AdminUrl)

    Connect-SPOService -Url $AdminUrl
    $sites = Get-SPOSite -Limit All | Where-Object { $_.Template -notlike "*SPSPERS*" }

    $results = @()
    foreach ($site in $sites) {
        try {
            Connect-PnPOnline -Url $site.Url -Interactive
            $copilotReady = Get-PnPPropertyBag -Key "CopilotReady"

            $results += [PSCustomObject]@{
                SiteUrl = $site.Url
                Title = $site.Title
                CopilotReady = if ($copilotReady) { $copilotReady } else { "Not Set" }
                RestrictedFromCopilot = $site.RestrictContentOrgWideSearchAndCopilot
            }
        } catch {
            Write-Warning "Could not check $($site.Url): $_"
        }
    }

    return $results
}

# Get all sites with CopilotReady status
$copilotStatus = Get-CopilotReadySites -AdminUrl "https://tenant-admin.sharepoint.com"
$copilotStatus | Export-Csv -Path "CopilotReady-Status.csv" -NoTypeInformation
```

### Step 5: Configure Graph API Filters (Advanced)

**Restrict Copilot Data Access via Graph:**

For programmatic control over what data Microsoft 365 Copilot can access:

```powershell
# Use Microsoft Graph to query and configure Copilot-related settings
Connect-MgGraph -Scopes "Sites.ReadWrite.All", "Sites.Manage.All"

# Note: Specific Graph APIs for Copilot indexing control
# are evolving - check Microsoft Learn for current capabilities

# Example: Query site settings via Graph
$siteId = "tenant.sharepoint.com,site-guid,web-guid"
$settings = Invoke-MgGraphRequest -Method GET `
    -Uri "https://graph.microsoft.com/v1.0/sites/$siteId/settings"

Write-Host ($settings | ConvertTo-Json -Depth 4)
```

### Step 6: Establish Monitoring and Audit

**Audit Grounding Scope Changes:**

```kql
// Track changes to site Copilot settings
SharePointAuditLogs
| where TimeGenerated > ago(30d)
| where Operation == "SiteCollectionSettingsChanged"
| where ModifiedProperty contains "RestrictContentOrgWideSearchAndCopilot"
| project TimeGenerated, UserId, SiteUrl, OldValue, NewValue
| order by TimeGenerated desc
```

**Monitor Copilot Access to Sites:**

```kql
// Track which sites Copilot is accessing
CopilotInteraction
| where TimeGenerated > ago(7d)
| where SourceType == "SharePoint"
| summarize AccessCount = count(), UniqueUsers = dcount(UserId) by SourceSiteUrl
| order by AccessCount desc
```

---

### PowerShell Configuration

### Comprehensive Grounding Scope Audit Script

```powershell
# ============================================================
# Control 4.6: Grounding Scope Governance
# Comprehensive Audit and Configuration Script
# ============================================================

param(
    [string]$TenantAdminUrl = "https://tenant-admin.sharepoint.com",
    [string]$OutputPath = ".\GroundingScope-Audit-$(Get-Date -Format 'yyyyMMdd')"
)

# Create output directory
New-Item -ItemType Directory -Path $OutputPath -Force | Out-Null

# Connect to SharePoint
Connect-SPOService -Url $TenantAdminUrl

Write-Host "=== Grounding Scope Governance Audit ===" -ForegroundColor Cyan
Write-Host "Tenant: $TenantAdminUrl" -ForegroundColor Cyan
Write-Host "Output: $OutputPath" -ForegroundColor Cyan

# ============================================================
# SECTION 1: Site Inventory with Copilot Status
# ============================================================

Write-Host "`nSection 1: Inventorying sites..." -ForegroundColor Yellow

$allSites = Get-SPOSite -Limit All | Where-Object { $_.Template -notlike "*SPSPERS*" }

$siteInventory = $allSites | ForEach-Object {
    [PSCustomObject]@{
        Url = $_.Url
        Title = $_.Title
        Template = $_.Template
        Owner = $_.Owner
        RestrictedFromCopilot = $_.RestrictContentOrgWideSearchAndCopilot
        SensitivityLabel = $_.SensitivityLabel
        LastContentModified = $_.LastContentModifiedDate
        StorageUsedGB = [math]::Round($_.StorageUsageCurrent / 1024, 2)
        ContentCategory = switch -Wildcard ($_.Url) {
            "*draft*" { "Draft" }
            "*archive*" { "Archive" }
            "*personal*" { "Personal" }
            "*test*" { "Test" }
            default { "Production" }
        }
    }
}

$siteInventory | Export-Csv -Path "$OutputPath\Site-Inventory.csv" -NoTypeInformation
Write-Host "Exported $($siteInventory.Count) sites to Site-Inventory.csv"

# ============================================================
# SECTION 2: Grounding Scope Summary
# ============================================================

Write-Host "`nSection 2: Grounding scope summary..." -ForegroundColor Yellow

$summary = @{
    TotalSites = $siteInventory.Count
    IndexedSites = ($siteInventory | Where-Object { -not $_.RestrictedFromCopilot }).Count
    ExcludedSites = ($siteInventory | Where-Object { $_.RestrictedFromCopilot }).Count
    DraftSites = ($siteInventory | Where-Object { $_.ContentCategory -eq "Draft" }).Count
    ArchiveSites = ($siteInventory | Where-Object { $_.ContentCategory -eq "Archive" }).Count
    ProductionSites = ($siteInventory | Where-Object { $_.ContentCategory -eq "Production" }).Count
}

Write-Host "`nGrounding Scope Summary:" -ForegroundColor Green
Write-Host "  Total Sites: $($summary.TotalSites)"
Write-Host "  Indexed (Copilot can access): $($summary.IndexedSites)" -ForegroundColor Green
Write-Host "  Excluded (Copilot cannot access): $($summary.ExcludedSites)" -ForegroundColor Yellow
Write-Host "  Draft Sites: $($summary.DraftSites)"
Write-Host "  Archive Sites: $($summary.ArchiveSites)"
Write-Host "  Production Sites: $($summary.ProductionSites)"

# ============================================================
# SECTION 3: Risk Assessment
# ============================================================

Write-Host "`nSection 3: Risk assessment..." -ForegroundColor Yellow

# Identify potentially risky inclusions
$riskyInclusions = $siteInventory | Where-Object {
    (-not $_.RestrictedFromCopilot) -and
    ($_.ContentCategory -in @("Draft", "Archive", "Test"))
}

if ($riskyInclusions.Count -gt 0) {
    Write-Host "`nWARNING: $($riskyInclusions.Count) non-production sites are indexed!" -ForegroundColor Red
    $riskyInclusions | Select-Object Url, Title, ContentCategory |
        Export-Csv -Path "$OutputPath\Risky-Inclusions.csv" -NoTypeInformation
    Write-Host "Exported to Risky-Inclusions.csv - review and consider exclusion"
}
else {
    Write-Host "No risky inclusions found" -ForegroundColor Green
}

# ============================================================
# SECTION 4: Recommendations
# ============================================================

Write-Host "`nSection 4: Generating recommendations..." -ForegroundColor Yellow

$recommendations = @()

# Recommend excluding draft sites
$draftIndexed = $siteInventory | Where-Object {
    $_.ContentCategory -eq "Draft" -and -not $_.RestrictedFromCopilot
}
if ($draftIndexed.Count -gt 0) {
    $recommendations += [PSCustomObject]@{
        Category = "Draft Content"
        Issue = "$($draftIndexed.Count) draft sites are indexed"
        Recommendation = "Exclude draft sites from Copilot"
        Priority = "High"
        Sites = ($draftIndexed.Url -join "; ")
    }
}

# Recommend excluding archive sites
$archiveIndexed = $siteInventory | Where-Object {
    $_.ContentCategory -eq "Archive" -and -not $_.RestrictedFromCopilot
}
if ($archiveIndexed.Count -gt 0) {
    $recommendations += [PSCustomObject]@{
        Category = "Archive Content"
        Issue = "$($archiveIndexed.Count) archive sites are indexed"
        Recommendation = "Exclude archive sites to prevent outdated information"
        Priority = "Medium"
        Sites = ($archiveIndexed.Url -join "; ")
    }
}

# Check for unlabeled high-storage sites
$unlabeledLarge = $siteInventory | Where-Object {
    $_.StorageUsedGB -gt 10 -and [string]::IsNullOrEmpty($_.SensitivityLabel)
}
if ($unlabeledLarge.Count -gt 0) {
    $recommendations += [PSCustomObject]@{
        Category = "Classification"
        Issue = "$($unlabeledLarge.Count) large sites lack sensitivity labels"
        Recommendation = "Apply sensitivity labels to large sites for governance"
        Priority = "Medium"
        Sites = ($unlabeledLarge.Url -join "; ")
    }
}

$recommendations | Export-Csv -Path "$OutputPath\Recommendations.csv" -NoTypeInformation
Write-Host "Generated $($recommendations.Count) recommendations"

# ============================================================
# SECTION 5: Generate HTML Report
# ============================================================

Write-Host "`nSection 5: Generating HTML report..." -ForegroundColor Yellow

$html = @"
<!DOCTYPE html>
<html>
<head>
    <title>Grounding Scope Governance Report</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; margin: 40px; }
        h1 { color: #0078d4; }
        .dashboard { display: flex; gap: 20px; flex-wrap: wrap; margin: 20px 0; }
        .card { padding: 20px; background: #f5f5f5; border-radius: 8px; min-width: 150px; }
        .card.success { background: #dff6dd; }
        .card.warning { background: #fff4ce; }
        .card.danger { background: #fde7e9; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { padding: 10px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background: #0078d4; color: white; }
    </style>
</head>
<body>
    <h1>Grounding Scope Governance Report</h1>
    <p>Generated: $(Get-Date -Format "yyyy-MM-dd HH:mm:ss")</p>

    <h2>Summary</h2>
    <div class="dashboard">
        <div class="card"><h3>Total Sites</h3><p style="font-size:28px;">$($summary.TotalSites)</p></div>
        <div class="card success"><h3>Indexed</h3><p style="font-size:28px;">$($summary.IndexedSites)</p></div>
        <div class="card warning"><h3>Excluded</h3><p style="font-size:28px;">$($summary.ExcludedSites)</p></div>
        <div class="card $(if ($riskyInclusions.Count -gt 0) { 'danger' } else { 'success' })">
            <h3>Risky Inclusions</h3><p style="font-size:28px;">$($riskyInclusions.Count)</p>
        </div>
    </div>

    <h2>Content Categories</h2>
    <table>
        <tr><th>Category</th><th>Count</th><th>Status</th></tr>
        <tr><td>Production</td><td>$($summary.ProductionSites)</td><td>Expected</td></tr>
        <tr><td>Draft</td><td>$($summary.DraftSites)</td><td>$(if ($draftIndexed.Count -gt 0) { "Review Needed" } else { "OK" })</td></tr>
        <tr><td>Archive</td><td>$($summary.ArchiveSites)</td><td>$(if ($archiveIndexed.Count -gt 0) { "Review Needed" } else { "OK" })</td></tr>
    </table>

    <h2>Recommendations</h2>
    $(if ($recommendations.Count -gt 0) {
        "<table><tr><th>Category</th><th>Issue</th><th>Recommendation</th><th>Priority</th></tr>"
        $recommendations | ForEach-Object {
            "<tr><td>$($_.Category)</td><td>$($_.Issue)</td><td>$($_.Recommendation)</td><td>$($_.Priority)</td></tr>"
        }
        "</table>"
    } else {
        "<p style='color:green;'>No recommendations - grounding scope governance is healthy!</p>"
    })

    <h2>Next Steps</h2>
    <ol>
        <li>Review risky inclusions and exclude as needed</li>
        <li>Implement CopilotReady metadata for approved sites</li>
        <li>Schedule quarterly grounding scope reviews</li>
        <li>Document scope decisions for compliance</li>
    </ol>
</body>
</html>
"@

$html | Out-File -FilePath "$OutputPath\Grounding-Scope-Report.html" -Encoding UTF8
Write-Host "HTML report generated: $OutputPath\Grounding-Scope-Report.html" -ForegroundColor Green

Write-Host "`n=== Audit Complete ===" -ForegroundColor Cyan
Write-Host "Review output in: $OutputPath" -ForegroundColor Cyan
```

---

## Financial Sector Considerations

### Regulatory Alignment

| Regulation | Requirement | How This Control Helps |
|------------|-------------|------------------------|
| **SEC 17a-3/4** | Records integrity and retention | Ensures agents access only finalized records |
| **GLBA 501(b)** | Information safeguards | Controls agent data access scope |
| **FINRA 4511** | Books and records | Prevents agents from citing draft documents |
| **SOX 302/404** | Internal controls | Documents data governance decisions |
| **OCC 2011-12** | Model risk (data quality) | Ensures agent grounding on accurate data |

### Zone-Specific Configuration

**Zone 1 (Personal Productivity):**

- Personal OneDrive content excluded by default
- Document personal site policy
- Minimal configuration needed
- Rationale: Personal productivity agents should only access individual user content

**Zone 2 (Team Collaboration):**

- Exclude draft and archive sites from team agent grounding
- Implement CopilotReady tagging for approved sites
- Monthly review of grounding scope
- Rationale: Team agents need controlled access to shared content

**Zone 3 (Enterprise Managed):**

- Explicit approval required for content in grounding scope
- All sources must be CopilotReady tagged
- Sensitivity label integration required
- Quarterly attestation from content owners
- Change control for grounding scope modifications
- Rationale: Enterprise agents require strictest content governance

### FSI Configuration Example

```yaml
# FSI Grounding Scope Configuration
fsi_grounding_scope:
  organization: "Regional Bank"
  control_id: "4.6"

  default_policy:
    new_sites: "Excluded"  # Explicit opt-in required
    draft_content: "Always Excluded"
    archive_content: "Always Excluded"
    personal_content: "Always Excluded"

  approval_workflow:
    required_approvers:
      - "Data Governance Officer"
      - "Content Owner"
    approval_criteria:
      - "Content is finalized and accurate"
      - "No draft or outdated information"
      - "Appropriate sensitivity label applied"
      - "Content review completed within 6 months"

  excluded_site_patterns:
    - "*draft*"
    - "*archive*"
    - "*test*"
    - "*sandbox*"
    - "*personal*"

  copilot_ready_sites:
    - url: "https://tenant.sharepoint.com/sites/ProductKnowledge"
      approved_by: "compliance@bank.com"
      approved_date: "2026-01-15"
      review_due: "2026-07-15"

  audit:
    review_frequency: "Quarterly"
    attestation_required: true
    retention_years: 7
```

---

## Verification & Testing

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | Run grounding scope audit script | Inventory generated |
| 2 | Verify draft sites are excluded | RestrictContentOrgWideSearchAndCopilot = true |
| 3 | Test Copilot query against excluded site | Content not returned |
| 4 | Test Copilot query against included site | Content returned appropriately |
| 5 | Verify CopilotReady metadata (if implemented) | Property bag values set |
| 6 | Review audit logs for scope changes | Changes logged |

### Compliance Checklist

- [ ] Site inventory completed with Copilot status
- [ ] Draft content excluded from grounding
- [ ] Archive content excluded from grounding
- [ ] Personal content policy documented
- [ ] CopilotReady tagging implemented (Level 2+)
- [ ] Quarterly review process established
- [ ] Change control for scope modifications (Level 4)
- [ ] Audit evidence retained

---

## Troubleshooting & Validation

<a id="troubleshooting"></a>

### Issue: Content Still Appearing After Exclusion

**Symptoms:** Copilot returns content from excluded site

**Resolution:**

1. Verify exclusion setting is applied (Get-SPOSite)
2. Allow up to 24 hours for index to update
3. Check for content in multiple locations (may exist elsewhere)
4. Verify user doesn't have direct access bypassing exclusion
5. Contact Microsoft support if issue persists

### Issue: Cannot Set Site Exclusion Property

**Symptoms:** Set-SPOSite fails with permission error

**Resolution:**

1. Verify SharePoint Admin role assignment
2. Check SharePoint Advanced Management license
3. Ensure site isn't locked or read-only
4. Try via SharePoint Admin Center UI
5. Verify tenant-level settings allow modification

### Issue: CopilotReady Property Not Persisting

**Symptoms:** Property bag values not saving

**Resolution:**

1. Verify PnP.PowerShell module is current version
2. Check site collection admin permissions
3. Ensure property bag is not read-only
4. Use Connect-PnPOnline with appropriate authentication
5. Verify site isn't in read-only or archive state

---

## Additional Resources

<a id="microsoft-learn-references"></a>

- [Microsoft 365 Copilot data, privacy, and security](https://learn.microsoft.com/en-us/microsoft-365-copilot/microsoft-365-copilot-privacy)
- [Restrict SharePoint content from Microsoft 365 Copilot](https://learn.microsoft.com/en-us/sharepoint/restrict-content-from-copilot)
- [Information Access Governance](https://learn.microsoft.com/en-us/sharepoint/information-access-governance)
- [SharePoint Advanced Management overview](https://learn.microsoft.com/en-us/sharepoint/advanced-management)
- [Control 4.1: SharePoint IAG and RCD](4.1-sharepoint-information-access-governance-iag-restricted-content-discovery.md)

---

## Related Controls

| Control | Relationship |
|---------|-------------|
| [Control 4.1: IAG/RCD](4.1-sharepoint-information-access-governance-iag-restricted-content-discovery.md) | Core site exclusion capability |
| [Control 1.5: DLP/Sensitivity Labels](../pillar-1-security/1.5-data-loss-prevention-dlp-and-sensitivity-labels.md) | Content classification |
| [Control 1.14: Data Minimization](../pillar-1-security/1.14-data-minimization-and-agent-scope-control.md) | Scope control principles |
| [Control 2.16: RAG Source Integrity](../pillar-2-management/2.16-rag-source-integrity-validation.md) | Knowledge source approval |

---

## Operational Templates

These operational templates support grounding scope governance:

- **[Per-Agent Data Policy](../../operational-templates/templates/per-agent-data-policy.md)** - Agent-specific data access rules
- **[Semantic Index Governance Queries](../../operational-templates/templates/semantic-index-governance-queries.md)** - KQL queries for index monitoring

---

## Support & Questions

For implementation support or questions about this control, contact:

- **SharePoint Administrator:** Site exclusion configuration
- **AI Governance Lead:** Grounding scope policy decisions
- **Compliance Officer:** Regulatory requirements for content access
- **Content Owners:** Site approval and CopilotReady certification

---

**Updated:** Jan 2026
**Version:** v1.0 (Jan 2026)
**UI Verification Status:** ❌ Needs verification
