# Control 4.4: Guest and External User Access Controls

## Overview

**Control ID:** 4.4
**Control Name:** Guest and External User Access Controls
**Regulatory Reference:** GLBA 501(b), 504(b), SEC Reg S-P, FINRA 4511
**Setup Time:** 30-45 min

---

## Purpose

Control external and guest user access to SharePoint content that may be used by AI agents. This prevents unauthorized external parties from accessing regulated content and ensures agent knowledge sources are protected from external exposure.

---

## Key Capabilities

### Site-Level External File Sharing

Configure sharing permissions per site.

**Navigation:** SharePoint Admin Center → Sites → Active sites → Select site → Settings tab

**Sharing Options:**

| Setting | Description | Use Case |
|---------|-------------|----------|
| Anyone | Anonymous sharing links allowed | Zone 1 only (if any) |
| New and existing guests | Guests can be added and access content | Zone 2 with controls |
| Existing guests | Only previously invited guests | Zone 2 restricted |
| Only people in your organization | No external sharing | Zone 3 requirement |

### Organization-Level Sharing Policies

Set default sharing restrictions across the tenant.

**Navigation:** SharePoint Admin Center → Policies → Sharing

**Key Settings:**

- External sharing slider (Most permissive → Least permissive)
- Guest access expiration
- Sharing link defaults
- Link expiration requirements

### Data Access Governance Reports

Monitor external sharing activity.

**Navigation:** SharePoint Admin Center → Reports → Data access governance

**Relevant Reports:**

| Report | Purpose |
|--------|---------|
| Sharing links | Monitor new sharing links created |
| Shared with 'Everyone except external users' | Identify oversharing risks |
| Site permissions across your organization | View sites with guest access |

---

## Governance Levels

### Baseline (Level 1)

| Requirement | Implementation |
|-------------|----------------|
| Restrict Zone 3 external sharing | Disable external sharing for sensitive sites |
| Document sharing settings | Inventory current sharing configuration |
| Guest access monitoring | Review sharing links report monthly |

**Implementation Steps:**

1. Navigate to [SharePoint Admin Center](https://admin.sharepoint.com)
2. Go to **Sites** → **Active sites**
3. For each Zone 3 site:
   - Select the site
   - Open **Settings** tab
   - Set "External file sharing" to **Only people in your organization**
4. Document configuration for compliance records

### Recommended (Level 2-3)

| Requirement | Implementation |
|-------------|----------------|
| Zone-based sharing policy | Zone 2: "Existing guests only"; Zone 3: Internal only |
| Guest access expiration | Configure 30-day expiration for guest links |
| Time-limited access | Set link expiration for Zone 2 sharing |
| Sharing activity monitoring | Weekly review of sharing reports |

**Additional Steps:**

1. Navigate to **Policies** → **Sharing**
2. Configure organization defaults:
   - Set external sharing to "Existing guests" or more restrictive
   - Enable "Guest access expires automatically"
   - Set expiration to 30 days
3. Configure link settings:
   - Default link type: "People in your organization"
   - Require link expiration: 30 days maximum
4. Schedule weekly sharing report reviews

### Regulated/High-Risk (Level 4)

| Requirement | Implementation |
|-------------|----------------|
| No external access to regulated content | All Zone 3 sites internal only |
| Guest access audit trail | All guest activities logged and reviewed |
| Conditional access for external users | MFA required for all guest access |
| Quarterly guest access certification | Review and certify all guest accounts |

**Additional Requirements:**

- Configure Conditional Access policies for guest users
- Implement guest access reviews in Entra ID
- Block guest access to sensitivity-labeled content
- Document all approved external sharing exceptions

---

## Verification & Testing

### Test Procedure

1. Navigate to SharePoint Admin Center → Sites → Active sites
2. Select a Zone 3 site and check Settings panel
3. Verify "External file sharing" is set to internal only
4. Navigate to Policies → Sharing
5. Verify organization-level sharing settings
6. Navigate to Reports → Data access governance
7. Run sharing reports to identify any external sharing

**Expected Results:**

- [ ] Zone 3 sites have external sharing disabled
- [ ] Organization defaults restrict external sharing
- [ ] Guest access expiration is configured
- [ ] No unauthorized sharing links exist
- [ ] Sharing reports accessible for monitoring

### Verification Evidence

| Evidence Type | Location | Retention |
|---------------|----------|-----------|
| Site sharing settings screenshot | Active sites → Settings | 1 year |
| Organization sharing policy screenshot | Policies → Sharing | 1 year |
| Sharing links report export | Data access governance | 1 year |
| Guest access review records | Governance documentation | 6 years |

---

## Implementation Guidance

### Step 1: Inventory Current Sharing State

Assess current external sharing:

1. Navigate to **Reports** → **Data access governance**
2. View "Site permissions across your organization" report
3. Identify sites with guest access enabled
4. Export report for analysis
5. Cross-reference with zone classification

### Step 2: Configure Site-Level Restrictions

For Zone 3 sites:

1. Navigate to **Sites** → **Active sites**
2. Select the site
3. Open **Settings** tab
4. Set "External file sharing" to **Only people in your organization**
5. Repeat for all Zone 3 sites

For Zone 2 sites:

1. Set "External file sharing" to **Existing guests** at most
2. Document any approved guest access with business justification

### Step 3: Configure Organization Policies

Set organization defaults:

1. Navigate to **Policies** → **Sharing**
2. Configure external sharing level
3. Enable guest access expiration (30 days recommended)
4. Set default link type to internal
5. Enable link expiration requirements

### Step 4: Implement Monitoring

Establish ongoing monitoring:

1. Schedule weekly review of sharing reports
2. Configure alerts for new external sharing (if available)
3. Document all guest access approvals
4. Review expired guest accounts quarterly

### Step 5: Document Procedures

Create procedures for:

- Requesting guest access (approval workflow)
- Reviewing guest access (quarterly certification)
- Revoking guest access (termination process)
- Exception handling (documented justification)

---

## Microsoft Learn References

- [Manage sharing settings in SharePoint](https://learn.microsoft.com/en-us/sharepoint/turn-external-sharing-on-or-off)
- [External sharing overview](https://learn.microsoft.com/en-us/sharepoint/external-sharing-overview)
- [Guest access expiration](https://learn.microsoft.com/en-us/sharepoint/turn-external-sharing-on-or-off#guest-access-to-a-site-or-onedrive-will-expire-automatically)
- [Data access governance reports](https://learn.microsoft.com/en-us/sharepoint/data-access-governance-reports)

---

## Regulatory Context

**Primary Regulations:** GLBA 501(b), 504(b), SEC Reg S-P, FINRA 4511

| Regulation | Requirement | How This Control Addresses |
|------------|-------------|---------------------------|
| GLBA 501(b) | Protect NPI from unauthorized access | Restricts external access to customer data |
| SEC Reg S-P | Safeguard customer information | Controls third-party access |
| FINRA 4511 | Protect books and records | Prevents unauthorized external access |

---

## Related Controls

| Control | Relationship |
|---------|--------------|
| [1.11 Conditional Access](../pillar-1-security/1.11-conditional-access-and-phishing-resistant-mfa.md) | MFA requirements for external users |
| [1.5 DLP](../pillar-1-security/1.5-data-loss-prevention-dlp-and-sensitivity-labels.md) | DLP can block external sharing |
| [4.1 IAG / RCD](4.1-sharepoint-information-access-governance-iag-restricted-content-discovery.md) | Complements access restrictions |
| [4.2 Access Reviews](4.2-site-access-reviews-and-certification.md) | Reviews include guest access verification |

---

## Support & Questions

For implementation support or questions about this control, contact:

- **SharePoint Administrator:** Sharing configuration
- **Security Administrator:** Conditional access policies
- **Compliance Officer:** Guest access requirements

---

*Last Updated: December 2025*
*Version: 1.0 Beta*
