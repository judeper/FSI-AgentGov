# Control 2.1: Managed Environments

## Overview

**Control ID:** 2.1
**Control Name:** Managed Environments
**Regulatory Reference:** FINRA 4511, SEC 17a-4, GLBA 501(b), SOX 302
**Setup Time:** 30-45 min per environment

---

## Description

Managed Environments provide premium governance capabilities for Power Platform environments, enabling centralized control over sharing, solution deployment, usage insights, and maker onboarding. In FSI organizations, Managed Environments are essential for enforcing governance policies at the environment level.

See [Managed Environments overview](https://learn.microsoft.com/en-us/power-platform/admin/managed-environment-overview) for detailed capabilities.

---

## Key Capabilities

When an environment is managed, administrators gain access to:

| Capability | Description | FSI Relevance |
|------------|-------------|---------------|
| **Manage sharing** | Limit how widely apps, flows, and agents can be shared | Prevents oversharing of sensitive tools |
| **Solution checker enforcement** | Block/warn on solution imports with security issues | Ensures code quality and security |
| **Usage insights** | Weekly digest of top apps and flows | Adoption monitoring and shadow AI detection |
| **Maker welcome content** | Custom onboarding guidance for makers | Policy communication and training |
| **Data policies** | View and enforce active DLP policies | Data boundary enforcement |

---

## Governance Levels

### Level 1 - Baseline

| Setting | Configuration |
|---------|---------------|
| Managed Environment | Enabled for Zone 2+ environments |
| Manage sharing | Default (no limits) |
| Solution checker | None |
| Usage insights | Disabled |

**Minimum requirements:**
- Enable Managed Environment status
- Document environment classification

### Level 2-3 - Recommended

| Setting | Configuration |
|---------|---------------|
| Managed Environment | Enabled for all non-personal environments |
| Manage sharing | Limits configured per resource type |
| Solution checker | Warn |
| Usage insights | Enabled with weekly digest |
| Maker welcome content | Governance policy summary |

**FSI recommendations:**
- Configure sharing limits for Copilot Studio agents
- Enable usage insights for compliance monitoring
- Add maker welcome content with policy links

### Level 4 - Regulated/High-Risk

| Setting | Configuration |
|---------|---------------|
| Managed Environment | **Mandatory** for all Zone 3 environments |
| Manage sharing | Strict limits (security groups only) |
| Solution checker | **Block** (prevent non-compliant imports) |
| Usage insights | Enabled with additional recipients (Compliance) |
| Maker welcome content | Full governance policy with acknowledgment |
| Data policies | Active DLP policies visible and enforced |

**FSI requirements:**
- Solution checker set to Block for production environments
- Compliance team added to usage insights digest
- Maker welcome content includes regulatory requirements

---

## Configuration Steps

### Step 1: Navigate to Environment

1. Open [Power Platform Admin Center](https://admin.powerplatform.microsoft.com)
2. Select **Environments** in left navigation
3. Click on the target environment name

### Step 2: Access Managed Environment Settings

1. Locate the **Managed environments** card on the environment page
2. Click **Edit managed environments** link
   - Or use toolbar button: **Edit managed environments**

### Step 3: Configure Sharing Limits

In the "Manage sharing" section, configure limits for each resource type:

#### Power Apps
- Expand **Power Apps** section
- Select: "Don't set limits" OR configure sharing restrictions

#### Power Automate
- Expand **Power Automate** section
- Configure flow sharing limits

#### Copilot Studio

Expand **Copilot Studio** section to configure agent sharing:

**Editors:**
- ☑️/☐ "Let people grant Editor permissions when agents are shared"

**Viewers:**
- ☑️/☐ "Let people grant Viewer permissions when agents are shared"
- ☐ "Only share with individuals (no security groups)" - Prevents sharing with security groups
- ☐ "Limit the number of viewers who can access each agent" - Set numeric limit

**Zone Recommendations:**

| Zone | Editors | Viewers | Individuals Only | Viewer Limit |
|------|---------|---------|------------------|--------------|
| Zone 1 | ☐ Disabled | ☐ Disabled | N/A | N/A |
| Zone 2 | ☑️ Enabled | ☑️ Enabled | ☐ No | No limit |
| Zone 3 | ☐ Disabled | ☑️ Enabled | ☐ No | Consider limit |

> **Note:** Sharing limits do not apply when agent authentication is set to "No authentication". Always enable authentication for Zone 2+ agents.

See [Sharing limits](https://learn.microsoft.com/en-us/power-platform/admin/managed-environment-sharing-limits) for details.

### Step 4: Configure Solution Checker

1. Locate **Solution checker enforcement** section
2. Set enforcement level using slider:
   - **None:** No enforcement (Zone 1 only)
   - **Warn:** Email notifications on issues (Zone 2)
   - **Block:** Prevent import of solutions with issues (Zone 3)
3. Optionally configure excluded rules
4. Enable email notifications: "Send emails only when a solution is blocked"

**FSI Recommendation:** Set to **Block** for production (Zone 3) environments to prevent deployment of solutions with security vulnerabilities.

### Step 5: Enable Usage Insights

1. Locate **Usage insights** section
2. Check **Include insights for this environment in the weekly email digest**
3. Check **Add additional recipients for the weekly digest** and add:
   - Compliance Officer email
   - Security Team distribution list

See [Usage insights](https://learn.microsoft.com/en-us/power-platform/admin/managed-environment-usage-insights) for details.

### Step 6: Configure Maker Welcome Content

1. Locate **Maker welcome content** section
2. Enter governance guidance in Markdown or plain text (1500 character limit)
3. Add **Learn more link** to full policy documentation
4. Click **See preview** to verify formatting

**Example content for Zone 2:**
```
## Welcome to [Environment Name]

This is a **Zone 2 Team Environment**. Before creating agents:

- Review the Agent Governance Policy
- Complete required training
- All agents require manager approval before sharing

Contact governance@company.com for questions.
```

### Step 7: Configure AI Features (Optional)

1. Locate **Enable AI-generated app descriptions (preview)** section
2. Enable/disable based on organization policy
3. Review warning about potential inaccuracies

### Step 8: Review Data Policies

1. Locate **Data policies** section
2. Check **See active data policies for this environment**
3. Verify appropriate DLP policies are applied

### Step 9: Save Configuration

1. Review all settings
2. Click **Save** to apply changes
3. Verify settings are active by reopening the panel

---

## Verification & Testing

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | Navigate to Environment in PPAC | Environment details displayed |
| 2 | Check Managed environments card | Shows "Yes" |
| 3 | Click Edit managed environments | Settings panel opens |
| 4 | Review Copilot Studio sharing | Configured per zone recommendations |
| 5 | Review solution checker | Set to appropriate level (Warn/Block) |
| 6 | Test solution import (if Block) | Non-compliant solutions blocked |
| 7 | Verify usage insights | Weekly digest received |

---

## Integration with Environment Groups

Managed Environments work with [Environment Groups](https://learn.microsoft.com/en-us/power-platform/admin/environment-groups) to provide layered governance:

| Layer | Controls | Scope |
|-------|----------|-------|
| **Environment Groups** | Rules (sharing, channels, authentication) | Multiple environments |
| **Managed Environments** | Sharing limits, solution checker, usage insights | Single environment |

**Best Practice:** Use environment groups for broad policy enforcement across zones, and Managed Environment settings for environment-specific tuning.

**Interaction Note:** Environment group rules and Managed Environment settings work together. The more restrictive setting takes precedence.

---

## Regulatory Context

**Primary Regulations:** FINRA 4511, SEC 17a-4, GLBA 501(b), SOX 302

| Regulation | Managed Environment Support |
|------------|----------------------------|
| FINRA 4511 | Usage insights provide activity records for books and records |
| SEC 17a-4 | Solution checker enforces change control for recordkeeping |
| GLBA 501(b) | Sharing limits protect customer information |
| SOX 302 | Maker welcome content documents policy acknowledgment |

---

## Related Controls

- [Control 2.2: Environment Groups](./2.2-environment-groups-and-tier-classification.md) - Group-level governance rules
- [Control 2.15: Environment Routing](./2.15-environment-routing.md) - Automatic maker placement
- [Control 1.4: Advanced Connector Policies](../pillar-1-security/1.4-advanced-connector-policies-acp.md) - Data policies
- [Control 2.3: Change Management](./2.3-change-management-and-release-planning.md) - Solution deployment controls

---

## Support & Questions

For implementation support or questions about this control, contact:
- AI Governance Lead (governance direction)
- Compliance Officer (regulatory requirements)
- Power Platform Admin (technical setup)

---

*Last Updated: December 2025*
*Version: 1.0 Beta*
