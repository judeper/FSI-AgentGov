# Control 1.4: Advanced Connector Policies (ACP)

## Overview

**Control ID:** 1.4  
**Control Name:** Advanced Connector Policies (ACP)  
**Regulatory Reference:** FINRA 4511(c), GLBA 501(b), SEC Rule 17a-4  
**Setup Time:** 30-45 min  

---

## Prerequisites

**Primary Owner Admin Role:** Power Platform Admin
**Supporting Roles:** Environment Admin

- **License Required:** [Power Platform Premium](https://learn.microsoft.com/en-us/power-platform/admin/pricing-billing-skus) (per-environment license)
- **Admin Role:** Power Platform Administrator in Microsoft Entra ID
- **Dependencies:**
  - [Control 2.1: Managed Environments](../pillar-2-management/2.1-managed-environments.md) must be enabled first
  - [Control 2.2: Environment Groups](../pillar-2-management/2.2-environment-groups-and-tier-classification.md) must be created
- **Data Residency / Scope:** US-only deployments. Ensure the target Power Platform environments are created in a **United States** region and that approved connectors and endpoints do not require processing or storage outside the United States.
- **Additional Requirements:** This is a preview feature subject to change.

---

## Governance Levels

### Baseline (Level 1)

Block high-risk connectors/actions via DLP policies; approve only business-justified connectors.

### Recommended (Level 2-3)

Use ACP to whitelist safe actions per connector; quarterly policy review.

### Regulated/High-Risk (Level 4)

Action-level allowlisting + separation of duties; approvals for new connectors; continuous monitoring.

---

## Setup & Configuration

### Portal-Based Configuration (Primary Method)

**Before you start (evidence-grade prerequisites):**

- Confirm the target environments are:
   - In a **United States** region (environment region/data residency aligned to US-only requirements)
   - Enabled as **Managed Environments** ([Control 2.1](../pillar-2-management/2.1-managed-environments.md))
   - Members of an **Environment Group** that maps to a regulated tier/classification ([Control 2.2](../pillar-2-management/2.2-environment-groups-and-tier-classification.md))
- Confirm the organization has a documented **approved connector catalog** (allowlist) and **restricted connector catalog** (denylist) with an owner, review cadence, and change control ticketing.

**Step 1: Enable Managed Environments** (if not already enabled)

1. Sign in to the **Power Platform Admin Center** ([https://admin.powerplatform.microsoft.com](https://admin.powerplatform.microsoft.com))
2. Navigate to **Manage** > **Environments**
3. Select the ellipsis (**...**) next to your target environment
4. Select **Enable Managed Environments**
5. Configure the settings:
   - **For Financial Sector**: Enable all security features
   - Weekly digest: Enabled (for compliance tracking)
   - Limit sharing: Enabled (prevent unauthorized data exposure)
6. Select **Enable**

[Screenshot needed: Managed Environments enablement dialog with all options visible]

**Step 2: Create Environment Group**

1. In Power Platform Admin Center, select **Manage** > **Environment Groups**
2. Select **New group**
3. Add a **Name**: Example for FSI: `FSI-Production-Agents` or `Regulated-Banking-Environments`
4. Add a **Description**: `Regulated production environments for financial services Copilot Studio agents - SOX and FINRA compliant`
5. Select **Add environments** and choose your managed environments
6. Select **Create**

[Screenshot needed: Environment Group creation screen]

**Step 3: Configure Advanced Connector Policy**

1. Select the environment group you created
2. Select the **Rules** tab
3. Select **Advanced connector policies (preview)**
4. Configure allowed connectors and actions:
   - **Default behavior**: Non-blockable connectors (Microsoft Dataverse, Office 365) are pre-loaded
   - Select **Add connectors** to add certified connectors
   - **For Financial Sector**: Use an **explicit allowlist** approach—only add connectors that have documented business justification and a completed security/vendor review
   - To block a connector, select it and choose **Remove connector**
5. **FSI Recommended Allowlist**:
   - Microsoft Dataverse
   - SharePoint
   - Microsoft Teams
   - Office 365 Users
   - Internal custom connectors (verified by security team)
6. **FSI Recommended Blocklist**:
   - Social media connectors (Twitter, Facebook, LinkedIn)
   - Public cloud storage (Dropbox, Box)
   - Consumer file sharing services
   - Any connector that transmits data outside your tenant

7. Configure **action-level allowlisting** (recommended for regulated environments):

   - For each allowed connector, set the policy to **allow only the minimum required actions** for agent scenarios.
   - Prefer **read-only** actions by default; require change control for any write/update/delete actions.

   **Example action guidance (adjust to your use cases and connector capabilities):**

   - **Microsoft Dataverse**
     - Allow: read/query (e.g., list/get rows)
     - Restrict: create/update/delete rows unless a regulated business use case exists
   - **SharePoint**
     - Allow: read/list/get content needed for retrieval-augmented responses
     - Restrict: create/update/delete files, manage permissions/sharing links
   - **Microsoft Teams**
     - Allow: post messages to approved channels for escalation
     - Restrict: create teams/channels, add members, export/tenant-wide search actions
   - **Custom connectors (internal APIs)**
     - Allow: specific, documented endpoints only
     - Restrict: wildcard endpoints, admin functions, bulk export endpoints

8. Select **Save**
9. Select **Publish rules** to apply across all environments in the group

[Screenshot needed: Advanced Connector Policies configuration screen with list of connectors]

**Step 3B (Required for DLP boundaries): Configure Data Loss Prevention (DLP) policy alignment**

ACP is not a replacement for DLP. Use DLP to define **data loss prevention boundaries** (Business / Non-Business / Blocked) and prevent data from crossing trust boundaries.

1. In Power Platform Admin Center, go to **Policies** > **Data policies**
2. Select an existing policy aligned to your regulated tier, or select **New policy**
3. Configure connector groups:
   - **Business**: enterprise/tenant-approved connectors required by agents
   - **Non-Business**: generally prohibited for regulated agent environments
   - **Blocked**: connectors explicitly disallowed (high-risk, consumer, or external data egress)
4. Scope the DLP policy to the same environments covered by your environment group (or apply tenant-wide if that matches your governance model)
5. Select **Save**

[Screenshot needed: DLP policy connector grouping and environment scope]

<a id="configuration-matrix"></a>

**Configuration Matrix by Governance Tier:**

| Setting | Baseline (Tier 1) | Recommended (Tier 2) | Regulated (Tier 3) |
|---------|-------------------|----------------------|--------------------|
| **Connector approach** | DLP-based blocking | ACP allowlist | Strict ACP allowlist |
| **Social media** | Block via DLP | Block via ACP | Block via ACP |
| **External storage** | Warn | Block | Block |
| **Custom connectors** | No restriction | Security review | Security + legal review |
| **Review frequency** | Annual | Quarterly | Monthly |

**Step 4: Verify Policy Application**

1. Navigate to **Manage** > **Environments**
2. Select an environment in your group
3. Confirm that the environment shows as part of the group
4. Test by attempting to create a connection using a blocked connector—should be prevented
5. Test action-level restrictions (if configured): attempt to add a flow/action that is not allowed for an otherwise-allowed connector—should be prevented or blocked at runtime depending on the feature behavior

**Evidence note:** capture a screenshot of the policy in **Published** status and the blocked connector/action error banner shown to a test maker account.

### PowerShell Configuration (Alternative Method)

```powershell
# Prerequisites: Install Power Platform Admin modules
# Install-Module -Name Microsoft.PowerApps.Administration.PowerShell -Scope CurrentUser

# Connect to Power Platform
Add-PowerAppsAccount

# Enable Managed Environment (required for ACP)
$EnvironmentName = "your-environment-id-here"
$GovernanceConfiguration = [pscustomobject]@{
    protectionLevel = "Standard"  # Use "Standard" for FSI
    settings = [pscustomobject]@{
        extendedSettings = @{
            # FSI recommended settings
            "limitSharingMode" = "excludeSharingToSecurityGroups"
            "solutionCheckerEnforcement" = "block"
        }
    }
}

Set-AdminPowerAppEnvironmentGovernanceConfiguration `
    -EnvironmentName $EnvironmentName `
    -UpdatedGovernanceConfiguration $GovernanceConfiguration

# Note: Advanced Connector Policies currently require portal configuration
# PowerShell support is limited as of December 2025
# Use the portal for ACP configuration

# Validation: Check Managed Environment status
Get-AdminPowerAppEnvironment -EnvironmentName $EnvironmentName |
    Select-Object DisplayName, EnvironmentName, GovernanceConfiguration

Write-Host "Managed Environment enabled. Configure ACP via portal." -ForegroundColor Yellow
```

If your organization collects evidence via automation, also capture:

- DLP policies (inventory and scope)
- Environment group membership
- Connector/connection inventory per environment

PowerShell cmdlet availability varies by module version and tenant configuration; use as evidence support, not as the primary control implementation method.

---

## Financial Sector Considerations

### US-Only Boundary (Data Residency and Connector Egress)

This control is written for US-only deployments. Enforce a US-only boundary by combining:

- **Environment region**: create regulated environments in a **United States** region.
- **DLP boundaries**: classify connectors that can move data outside approved US-controlled systems as **Blocked** or **Non-Business**.
- **ACP allow/deny + action allowlisting**: constrain agent tools to the minimum connector set and minimum actions required.
- **Vendor/connector review**: for third-party connectors, document whether the service processes/stores data outside the US and block if it cannot meet US-only requirements.

### Regulatory Alignment

| Regulation | Requirement | How This Control Helps |
|------------|-------------|------------------------|
| **FINRA Rule 3110** (Supervision) | Supervise data access | ACP controls which external data sources agents can access, ensuring all data flows are auditable |
| **SEC Regulation S-P** (Privacy) | Privacy safeguards | Blocks unauthorized connectors that could leak customer NPI (Non-Public Information) |
| **SOX Section 404** (Internal Controls) | Control data integration | Provides technical control over data integration points in financial reporting systems |
| **GLBA Safeguards Rule** | Prevent unauthorized data transmission | Prevents unauthorized data transmission to non-secure external systems |
| **FINRA 4511(c)** | Records of communications | Audit logging of all connector usage for compliance examination |

### Zone-Specific Configuration

**Zone 1 (Personal Productivity):**

- Applies to personal productivity agents.
- Allow: Microsoft 365 Graph connectors only (Calendar, Mail, OneDrive)
- Block: All external and third-party connectors
- Approach: Use standard DLP rather than ACP
- Rationale: Personal agents handle employee data but should not access customer PII

**Zone 2 (Team Collaboration):**

- Applies to team collaboration agents.
- Allow: Microsoft 365 + internal business system connectors (SharePoint, Teams, approved internal APIs)
- Block: All public connectors and unapproved third-party services
- Approach: ACP with managed allowlist
- Rationale: Team agents may access shared customer data but must remain within controlled boundaries

**Zone 3 (Enterprise Managed):**

- Applies to enterprise managed agents, including customer-facing agents.
- Allow: Only explicitly approved connectors with full audit trails
- Require: Data classification validation for each connector
- Block: All connectors by default (strict allowlist)
- Approach: ACP with strict governance and legal review
- Rationale: Direct customer interaction requires highest security and regulatory compliance

### FSI Implementation Example

**Scenario:** Regional bank deploying customer service agents for account inquiries

**Approved Connectors:**

1. Microsoft Dataverse (customer account data)
2. Internal core banking system connector (read-only, certified)
3. SharePoint (knowledge base articles)
4. Microsoft Teams (for agent escalation to human advisors)

**Blocked Connectors:**

1. All social media platforms
2. Public cloud storage (Dropbox, Google Drive, Box)
3. Consumer email services (Gmail, Yahoo)
4. Web scraping or public data connectors
5. AI services outside your tenant boundary

**Configuration Notes:**

- Document all connector approvals in change management system
- Quarterly review of connector usage via Power Platform audit logs
- Annual recertification of approved connectors by security team
- Incident response plan for unauthorized connector usage detection

---

## Verification & Testing

Use the steps below to generate audit-ready evidence that ACP + DLP boundaries are active and effective.

1. **Confirm prerequisites are satisfied (dependencies 2.1 and 2.2)**:
   - Power Platform Admin Center > **Manage** > **Environments**: verify environment shows **Managed Environment** enabled
   - Power Platform Admin Center > **Manage** > **Environment Groups**: verify environment is in the intended group
2. **Test blocked connector (denylist enforcement)**:
   - In Copilot Studio, create or open an agent in a regulated environment
   - Attempt to add a tool/flow that uses a blocked connector (e.g., social media)
   - Expected: connector is unavailable or connection creation is blocked with an administrator policy message
3. **Test action-level restriction (allowed connector, disallowed action)**:
   - Pick an allowed connector with restricted actions (e.g., SharePoint or Dataverse)
   - Attempt to use a disallowed action (e.g., delete/update)
   - Expected: action is blocked or prevented, depending on the ACP feature behavior for that connector
4. **Validate DLP boundaries (data crossing prevention)**:
   - Attempt to build a flow that combines a Business connector with a Non-Business/Blocked connector
   - Expected: the platform prevents cross-group data movement and displays a DLP policy error
5. **Review connector/connection inventory**:
   - Power Platform Admin Center > **Data** > **Connections**
   - Verify connections in regulated environments align with the allowlist and do not include prohibited connectors
6. **Audit policy and configuration changes**:
   - Microsoft Purview portal > **Audit** > **Search**
   - Search for Power Platform administration activities related to environment groups, DLP policies, and connector policy changes
   - Expected: changes are attributable to named admin identities and include timestamps

**EXPECTED:** Approved connectors work; blocked ones fail; violations logged

### Evidence Artifacts (attach to your control record)

Capture the following evidence artifacts for each regulated environment group:

1. **Environment Group evidence**
   - Screenshot: Environment group details showing the environment list and tier/classification
   - Screenshot: **Rules** tab showing **Advanced connector policies** with **Published** status
2. **ACP allow/deny configuration evidence**
   - Screenshot: connector list in ACP (allowlist/denylist state)
   - Screenshot(s): connector action restrictions (where available) for at least one high-risk connector scenario
3. **DLP boundary evidence**
   - Screenshot: DLP policy connector grouping (Business/Non-Business/Blocked)
   - Screenshot: DLP policy scope (environments included)
4. **Enforcement evidence**
   - Screenshot: blocked connector attempt in a regulated environment (error banner/message)
   - Screenshot: blocked cross-boundary (DLP) flow build attempt (policy violation message)
5. **Audit evidence**
   - Export: Purview audit results for the policy change window (include query parameters and time range)
6. **Change control evidence**
   - Ticket/record: connector approval request, vendor review decision, and implementation date

---

## Troubleshooting & Validation

### Common Issues

| Issue | Cause | Resolution |
|-------|-------|------------|
| "Advanced Connector Policies option not visible" | Environment is not a Managed Environment | Enable Managed Environments first (see Control 2.1) |
| "Environment not in a group" | Must create environment group first | Create environment group and add environment (Step 2) |
| "Policy not applying to existing connections" | Existing connections may persist even after policy changes | Perform an immediate connection inventory; remove non-compliant connections via **Data** > **Connections** and require re-creation under policy; document remediation |
| "Users report legitimate connectors are blocked" | Connector not in allowlist | Submit connector request through change management; security team approval required |
| "Cannot publish rules" | Insufficient permissions | Verify Power Platform Administrator role in Entra ID |
| "Connector is allowed but flow fails with policy error" | DLP boundary blocks cross-connector data movement | Review DLP grouping (Business/Non-Business/Blocked) and ensure the intended connector combination is permitted; prefer redesign over loosening policy |
| "Third-party connector cannot meet US-only requirements" | Service processes/stores data outside US | Block connector for regulated environments; document vendor decision and use an approved internal integration instead |

### How to Confirm Configuration is Active

1. **Via Portal:**
   - Power Platform Admin Center > **Manage** > **Environment Groups**
   - Select your FSI group > **Rules** tab
   - Confirm "Advanced connector policies" shows green checkmark
   - Confirm "Published" status appears

2. **Via User Testing:**
   - As a maker in the environment, create a new cloud flow
   - Attempt to add a blocked connector
   - Expected result: "This connector is blocked by your administrator" message

3. **Via DLP Validation:**
   - Create a cloud flow that attempts to move data between a Business connector and a Non-Business/Blocked connector
   - Expected result: DLP policy violation message and prevention of save/run

3. **Via Audit Log:**
   - Microsoft Purview portal > **Audit** > **Search**
   - Filter: Activity = "Blocked connector usage attempt"
   - Confirm blocked attempts are logged (tests your monitoring)

---

## Additional Resources

- [Microsoft Learn: Advanced connector policies](https://learn.microsoft.com/en-us/power-platform/admin/advanced-connector-policies)
- [Microsoft Learn: Enable Managed Environments](https://learn.microsoft.com/en-us/power-platform/admin/managed-environment-enable)
- [Microsoft Learn: Environment groups](https://learn.microsoft.com/en-us/power-platform/admin/environment-groups)
- [Microsoft Learn: Connector Reference](https://learn.microsoft.com/en-us/connectors/connector-reference/)
- [Microsoft Learn: DLP Strategy](https://learn.microsoft.com/en-us/power-platform/guidance/adoption/dlp-strategy)

---

## Related Controls

| Control | Relationship |
|---------|--------------|
| [2.1 - Managed Environments](../pillar-2-management/2.1-managed-environments.md) | Required dependency - must enable first |
| [2.2 - Environment Groups](../pillar-2-management/2.2-environment-groups-and-tier-classification.md) | Required dependency - groups needed for ACP |
| [1.5 - DLP and Sensitivity Labels](1.5-data-loss-prevention-dlp-and-sensitivity-labels.md) | Complementary control for data protection |
| [1.7 - Audit Logging](1.7-comprehensive-audit-logging-and-compliance.md) | Logs ACP policy enforcement events |
| [2.7 - Vendor Risk Management](../pillar-2-management/2.7-vendor-and-third-party-risk-management.md) | Third-party connectors require vendor assessment |

---

## Support & Questions

For implementation support or questions about this control, contact:

- **AI Governance Lead** (governance direction)
- **Compliance Officer** (regulatory requirements)
- **Technical Implementation Team** (platform setup)

---

**UI Verification Status:** ✅ Current
**Microsoft Learn Status:** ✅ Current
---

**Updated:** Dec 2025  
**Version:** v1.0 Beta (Dec 2025)  
**UI Verification Status:** ✅ Current
