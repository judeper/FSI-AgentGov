# Control 1.4: Advanced Connector Policies (ACP)

## Overview

**Control ID:** 1.4  
**Control Name:** Advanced Connector Policies (ACP)  
**Regulatory Reference:** FINRA 4511(c), GLBA 501(b), SEC Rule 17a-4  
**Setup Time:** 30-45 min  

---

## Prerequisites

- **License Required:** [Power Platform Premium](https://learn.microsoft.com/en-us/power-platform/admin/pricing-billing-skus) (per-environment license)
- **Admin Role:** Power Platform Administrator in Microsoft Entra ID
- **Dependencies:**
  - [Control 2.1: Managed Environments](../pillar-2-management/2.1-managed-environments.md) must be enabled first
  - [Control 2.2: Environment Groups](../pillar-2-management/2.2-environment-groups-and-tier-classification.md) must be created
- **Additional Requirements:** This is a preview feature subject to change

---

## Governance Levels

### Baseline (Level 1)

Block high-risk connectors/actions via DLP policies; approve only business-justified connectors.

### Recommended (Level 2-3)

Use ACP to whitelist safe actions per connector; quarterly policy review.

### Regulated/High-Risk (Level 4)

Action-level allowlisting + separation of duties; approvals for new connectors; continuous monitoring.

---

## Setup & Configuration

### Portal-Based Configuration (Primary Method)

**Step 1: Enable Managed Environments** (if not already enabled)

1. Sign in to the **Power Platform Admin Center** ([https://admin.powerplatform.microsoft.com](https://admin.powerplatform.microsoft.com))
2. Navigate to **Manage** > **Environments**
3. Select the ellipsis (**...**) next to your target environment
4. Select **Enable Managed Environments**
5. Configure the settings:
   - **For Financial Sector**: Enable all security features
   - Weekly digest: Enabled (for compliance tracking)
   - Limit sharing: Enabled (prevent unauthorized data exposure)
6. Select **Enable**

[Screenshot needed: Managed Environments enablement dialog with all options visible]

**Step 2: Create Environment Group**

1. In Power Platform Admin Center, select **Manage** > **Environment Groups**
2. Select **New group**
3. Add a **Name**: Example for FSI: `FSI-Production-Agents` or `Regulated-Banking-Environments`
4. Add a **Description**: `Regulated production environments for financial services Copilot agents - SOX and FINRA compliant`
5. Select **Add environments** and choose your managed environments
6. Select **Create**

[Screenshot needed: Environment Group creation screen]

**Step 3: Configure Advanced Connector Policy**

1. Select the environment group you created
2. Select the **Rules** tab
3. Select **Advanced connector policies (preview)**
4. Configure allowed connectors:
   - **Default behavior**: Non-blockable connectors (Microsoft Dataverse, Office 365) are pre-loaded
   - Select **Add connectors** to add certified connectors
   - **For Financial Sector**: Use allowlist approach—only add explicitly approved connectors
   - To block a connector, select it and choose **Remove connector**
5. **FSI Recommended Allowlist**:
   - Microsoft Dataverse
   - SharePoint
   - Microsoft Teams
   - Office 365 Users
   - Internal custom connectors (verified by security team)
6. **FSI Recommended Blocklist**:
   - Social media connectors (Twitter, Facebook, LinkedIn)
   - Public cloud storage (Dropbox, Box)
   - Consumer file sharing services
   - Any connector that transmits data outside your tenant
7. Select **Save**
8. Select **Publish rules** to apply across all environments in the group

[Screenshot needed: Advanced Connector Policies configuration screen with list of connectors]

**Configuration Matrix by Governance Level:**

| Setting | Baseline (Zone 1) | Recommended (Zone 2) | Regulated (Zone 3) |
|---------|-------------------|----------------------|--------------------|
| **Connector approach** | DLP-based blocking | ACP allowlist | Strict ACP allowlist |
| **Social media** | Block via DLP | Block via ACP | Block via ACP |
| **External storage** | Warn | Block | Block |
| **Custom connectors** | No restriction | Security review | Security + legal review |
| **Review frequency** | Annual | Quarterly | Monthly |

**Step 4: Verify Policy Application**

1. Navigate to **Manage** > **Environments**
2. Select an environment in your group
3. Confirm that the environment shows as part of the group
4. Test by attempting to create a connection using a blocked connector—should be prevented

### PowerShell Configuration (Alternative Method)

```powershell
# Prerequisites: Install Power Platform Admin modules
# Install-Module -Name Microsoft.PowerApps.Administration.PowerShell -Scope CurrentUser

# Connect to Power Platform
Add-PowerAppsAccount

# Enable Managed Environment (required for ACP)
$EnvironmentName = "your-environment-id-here"
$GovernanceConfiguration = [pscustomobject]@{
    protectionLevel = "Standard"  # Use "Standard" for FSI
    settings = [pscustomobject]@{
        extendedSettings = @{
            # FSI recommended settings
            "limitSharingMode" = "excludeSharingToSecurityGroups"
            "solutionCheckerEnforcement" = "block"
        }
    }
}

Set-AdminPowerAppEnvironmentGovernanceConfiguration `
    -EnvironmentName $EnvironmentName `
    -UpdatedGovernanceConfiguration $GovernanceConfiguration

# Note: Advanced Connector Policies currently require portal configuration
# PowerShell support is limited as of December 2025
# Use the portal for ACP configuration

# Validation: Check Managed Environment status
Get-AdminPowerAppEnvironment -EnvironmentName $EnvironmentName | 
    Select-Object DisplayName, EnvironmentName, GovernanceConfiguration

Write-Host "Managed Environment enabled. Configure ACP via portal." -ForegroundColor Yellow
```

---

## Financial Sector Considerations

### Regulatory Alignment

| Regulation | Requirement | How This Control Helps |
|------------|-------------|------------------------|
| **FINRA Rule 3110** (Supervision) | Supervise data access | ACP controls which external data sources agents can access, ensuring all data flows are auditable |
| **SEC Regulation S-P** (Privacy) | Privacy safeguards | Blocks unauthorized connectors that could leak customer NPI (Non-Public Information) |
| **SOX Section 404** (Internal Controls) | Control data integration | Provides technical control over data integration points in financial reporting systems |
| **GLBA Safeguards Rule** | Prevent unauthorized data transmission | Prevents unauthorized data transmission to non-secure external systems |
| **FINRA 4511(c)** | Records of communications | Audit logging of all connector usage for compliance examination |

### Zone-Specific Configuration

**Zone 1 (Personal Productivity Agents):**
- Allow: Microsoft 365 Graph connectors only (Calendar, Mail, OneDrive)
- Block: All external and third-party connectors
- Approach: Use standard DLP rather than ACP
- Rationale: Personal agents handle employee data but should not access customer PII

**Zone 2 (Team Collaboration Agents):**
- Allow: Microsoft 365 + internal business system connectors (SharePoint, Teams, approved internal APIs)
- Block: All public connectors and unapproved third-party services
- Approach: ACP with managed allowlist
- Rationale: Team agents may access shared customer data but must remain within controlled boundaries

**Zone 3 (Enterprise Customer-Facing Agents):**
- Allow: Only explicitly approved connectors with full audit trails
- Require: Data classification validation for each connector
- Block: All connectors by default (strict allowlist)
- Approach: ACP with strict governance and legal review
- Rationale: Direct customer interaction requires highest security and regulatory compliance

### FSI Implementation Example

**Scenario:** Regional bank deploying customer service agents for account inquiries

**Approved Connectors:**
1. Microsoft Dataverse (customer account data)
2. Internal core banking system connector (read-only, certified)
3. SharePoint (knowledge base articles)
4. Microsoft Teams (for agent escalation to human advisors)

**Blocked Connectors:**
1. All social media platforms
2. Public cloud storage (Dropbox, Google Drive, Box)
3. Consumer email services (Gmail, Yahoo)
4. Web scraping or public data connectors
5. AI services outside your tenant boundary

**Configuration Notes:**
- Document all connector approvals in change management system
- Quarterly review of connector usage via Power Platform audit logs
- Annual recertification of approved connectors by security team
- Incident response plan for unauthorized connector usage detection

---

## Verification & Testing

1. **Test Blocked Connector**:
   - In Copilot Studio, create a new agent in a managed environment
   - Attempt to add a flow that uses a blocked connector (e.g., Twitter)
   - Confirm that connection creation is prevented with policy message
2. **Review Connector Inventory**:
   - In Power Platform Admin Center, navigate to **Data** > **Connections**
   - Filter by environment group
   - Verify only allowed connectors appear
3. **Audit Policy Changes**:
   - In Microsoft Purview Audit log, search for "Advanced Connector Policy" activities
   - Verify all policy changes are logged with admin identity
4. **Quarterly Compliance Check**:
   - Export list of all connections across environments
   - Cross-reference with approved connector list
   - Investigate any discrepancies

**EXPECTED:** Approved connectors work; blocked ones fail; violations logged

---

## Troubleshooting & Validation

### Common Issues

| Issue | Cause | Resolution |
|-------|-------|------------|
| "Advanced Connector Policies option not visible" | Environment is not a Managed Environment | Enable Managed Environments first (see Control 2.1) |
| "Environment not in a group" | Must create environment group first | Create environment group and add environment (Step 2) |
| "Policy not applying to existing connections" | ACP applies to new connections only | Manually audit and remove non-compliant existing connections via **Data** > **Connections** |
| "Users report legitimate connectors are blocked" | Connector not in allowlist | Submit connector request through change management; security team approval required |
| "Cannot publish rules" | Insufficient permissions | Verify Power Platform Administrator role in Entra ID |

### How to Confirm Configuration is Active

1. **Via Portal:**
   - Power Platform Admin Center > **Manage** > **Environment Groups**
   - Select your FSI group > **Rules** tab
   - Confirm "Advanced connector policies" shows green checkmark
   - Confirm "Published" status appears

2. **Via User Testing:**
   - As a maker in the environment, create a new cloud flow
   - Attempt to add a blocked connector
   - Expected result: "This connector is blocked by your administrator" message

3. **Via Audit Log:**
   - Microsoft Purview portal > **Audit** > **Search**
   - Filter: Activity = "Blocked connector usage attempt"
   - Confirm blocked attempts are logged (tests your monitoring)

---

## Additional Resources

- [Microsoft Learn: Advanced connector policies](https://learn.microsoft.com/en-us/power-platform/admin/advanced-connector-policies)
- [Microsoft Learn: Enable Managed Environments](https://learn.microsoft.com/en-us/power-platform/admin/managed-environment-enable)
- [Microsoft Learn: Environment groups](https://learn.microsoft.com/en-us/power-platform/admin/environment-groups)
- [Microsoft Learn: Connector Reference](https://learn.microsoft.com/en-us/connectors/connector-reference/)
- [Microsoft Learn: DLP Strategy](https://learn.microsoft.com/en-us/power-platform/guidance/adoption/dlp-strategy)

---

## Related Controls

| Control | Relationship |
|---------|--------------|
| [2.1 - Managed Environments](../pillar-2-management/2.1-managed-environments.md) | Required dependency - must enable first |
| [2.2 - Environment Groups](../pillar-2-management/2.2-environment-groups-and-tier-classification.md) | Required dependency - groups needed for ACP |
| [1.5 - DLP and Sensitivity Labels](1.5-data-loss-prevention-dlp-and-sensitivity-labels.md) | Complementary control for data protection |
| [1.7 - Audit Logging](1.7-comprehensive-audit-logging-and-compliance.md) | Logs ACP policy enforcement events |
| [2.7 - Vendor Risk Management](../pillar-2-management/2.7-vendor-and-third-party-risk-management.md) | Third-party connectors require vendor assessment |

---

## Support & Questions

For implementation support or questions about this control, contact:
- **AI Governance Lead** (governance direction)
- **Compliance Officer** (regulatory requirements)
- **Technical Implementation Team** (platform setup)

---

**Last Updated:** December 17, 2025 (Portal UI verified)  
**Version:** 1.0 Beta  
**UI Verification Status:** ✅ Current  
**Microsoft Learn Status:** ✅ Current
