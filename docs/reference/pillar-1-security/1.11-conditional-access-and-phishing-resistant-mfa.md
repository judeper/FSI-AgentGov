# Control 1.11: Conditional Access and Phishing-Resistant MFA

## Overview

**Control ID:** 1.11
**Control Name:** Conditional Access and Phishing-Resistant MFA
**Regulatory Reference:** GLBA 501(b), FINRA 4511, SEC Reg SHO, SOX 302
**Setup Time:** 2-4 hours

---

## Description

Microsoft Entra Conditional Access provides adaptive access control for both human users and AI agents. With the introduction of **Microsoft Entra Agent ID (Preview)**, Conditional Access now treats AI agents as first-class identities, enabling Zero Trust policies for agent access.

See [Conditional Access overview](https://learn.microsoft.com/en-us/entra/identity/conditional-access/overview) and [Microsoft Entra Agent ID](https://learn.microsoft.com/en-us/entra/agent-id/identity-professional/microsoft-entra-agent-identities-for-ai-agents) for detailed capabilities.

---

## Key Capabilities

| Capability | Description | FSI Relevance |
|------------|-------------|---------------|
| **Conditional Access policies** | Risk-based access control | Adaptive security |
| **Phishing-resistant MFA** | FIDO2, passkeys, certificates | Strong authentication |
| **Agent identity protection** | Risk detection for AI agents | Agent security |
| **Authentication methods** | Configure allowed auth methods | Compliance enforcement |
| **Agent ID governance** | Sponsor-based agent lifecycle | Accountability |

---

## Entra ID Navigation

### Accessing Conditional Access

1. Open [Microsoft Entra admin center](https://entra.microsoft.com)
2. Navigate to **Entra ID → Conditional Access**
3. Access available management sections

### Conditional Access Navigation Structure

| Section | Path | Purpose |
|---------|------|---------|
| **Overview** | Conditional Access → Overview | Policy summary and insights |
| **Policies** | Conditional Access → Policies | Create and manage policies |
| **Deleted Policies** | Conditional Access → Deleted Policies (Preview) | Recover deleted policies |
| **Insights and reporting** | Conditional Access → Insights and reporting | Policy analytics |
| **Diagnose and solve problems** | Conditional Access → Diagnose and solve problems | Troubleshooting |

### Conditional Access - Manage Section

| Item | Purpose |
|------|---------|
| **Named locations** | Define trusted/untrusted locations |
| **Custom controls (Preview)** | External authentication providers |
| **Terms of use** | Acceptance requirements |
| **VPN connectivity** | VPN-based access control |
| **Authentication contexts** | Step-up authentication triggers |
| **Authentication strengths** | Define MFA strength requirements |
| **Classic policies** | Legacy policy management |

### Conditional Access - Monitoring Section

| Item | Purpose |
|------|---------|
| **Sign-in logs** | Authentication activity |
| **Audit logs** | Policy change history |

---

## Conditional Access Overview Dashboard

### Dashboard Tabs

| Tab | Purpose |
|-----|---------|
| **Getting started** | Setup guidance |
| **Overview** | Policy summary |
| **Coverage** | Policy coverage analysis |
| **Tutorials** | Learning resources |

### Policy Summary Cards

| Card | Description | FSI Action |
|------|-------------|------------|
| **Agent Identities** | Agent identities in tenant with protection status | **Monitor agent coverage** |
| **Policy Snapshot** | Enabled, Report-only, Off counts | Track policy state |
| **Users** | Users without policy coverage | Address coverage gaps |
| **Devices** | Unmanaged/non-compliant device sign-ins | Device compliance |
| **Applications** | Unprotected applications | Application coverage |

### What's New Announcements

The Overview page displays important announcements including:
- Conditional Access Insider Risk policy (Adaptive Protection)
- Named Locations IPv6 support
- Policy deprecation notices

---

## Conditional Access Policies

### Policy Management Actions

| Action | Description |
|--------|-------------|
| **+ New policy** | Create custom policy |
| **+ New policy from template** | Use Microsoft templates |
| **Upload policy file** | Import policy configuration |
| **What if** | Test policy impact |
| **Refresh** | Update policy list |
| **Preview features** | Enable preview capabilities |

### Policy Summary

| Category | Description |
|----------|-------------|
| **Microsoft-managed policies** | Policies managed by Microsoft |
| **User created policies** | Custom organizational policies |

### Policy Table Columns

| Column | Description |
|--------|-------------|
| Policy name | Policy identifier |
| Created by | USER or MICROSOFT |
| State | On, Off, Report-only |
| Alert | Policy alerts |
| Creation date | When policy was created |

### Sample FSI Policies

| Policy | State | Purpose |
|--------|-------|---------|
| Multifactor authentication for partners and vendors | On | External user MFA |
| Reauthentication on signin risk | On | Risk-based reauthentication |
| Secure password change on high user risk | On | Compromised account protection |
| Block access for users with Insider Risk | Report-only | Insider threat response |

---

## Authentication Methods

### Accessing Authentication Methods

1. Navigate to **Entra ID → Authentication methods**
2. Select **Policies** to configure methods

### Authentication Methods Navigation

| Section | Purpose |
|---------|---------|
| **Policies** | Configure authentication methods |
| **Password protection** | Password policy settings |
| **Registration campaign** | Drive MFA adoption |
| **Authentication strengths** | Define strength levels |
| **Settings** | Global authentication settings |

### Authentication Method Policies

| Method | FSI Recommendation | Phishing-Resistant |
|--------|-------------------|-------------------|
| **Passkey (FIDO2)** | Enable for Zone 3 | ✅ Yes |
| **Microsoft Authenticator** | Enable for all | ⚠️ With number matching |
| **SMS** | Disable | ❌ No |
| **Temporary Access Pass** | Enable for onboarding | ❌ No |
| **Hardware OATH tokens** | Enable for high-security | ⚠️ Partial |
| **Software OATH tokens** | Enable as backup | ⚠️ Partial |
| **Voice call** | Disable | ❌ No |
| **Email OTP** | Disable for primary auth | ❌ No |
| **Certificate-based authentication** | Enable for Zone 3 | ✅ Yes |
| **QR code** | Disable | ❌ No |

### FSI Authentication Strength Requirements

| Zone | Minimum Requirement | Recommended |
|------|---------------------|-------------|
| Zone 1 | MFA (any method) | Microsoft Authenticator |
| Zone 2 | MFA with number matching | Authenticator + backup |
| Zone 3 | Phishing-resistant MFA | FIDO2/Passkey or Certificate |

---

## Microsoft Entra Agent ID (Preview)

Microsoft Entra Agent ID extends Zero Trust identity protection to AI agents. This is a **critical new capability** for FSI agent governance.

### Accessing Agent ID

1. Navigate to **Entra ID → Agent ID (Preview)**
2. Access available management sections

### Agent ID Navigation Structure

| Section | Path | Purpose |
|---------|------|---------|
| **Overview (Preview)** | Agent ID → Overview | Agent dashboard and metrics |
| **All agent identities (Preview)** | Agent ID → All agent identities | Complete agent identity list |
| **Agent registry (Preview)** | Agent ID → Agent registry | Cross-platform agent discovery |
| **Agent collections (Preview)** | Agent ID → Agent collections | Trust-based agent grouping |
| **Sign-in logs (Preview)** | Agent ID → Sign-in logs | Agent authentication activity |

---

## Agent ID Overview Dashboard

### Agents in Your Tenant

The Overview displays total agent count with growth percentage:
- **Total agents** - All agent identities
- **Growth %** - Change over time

Description: "Gain full visibility into all agent identities in your tenant, apply governance policies, and secure them by default with Entra's integrated registry and lifecycle controls."

### Agent Metrics Cards

| Card | Description | FSI Action |
|------|-------------|------------|
| **Recently created** | Agents created in last 30 days | Monitor growth |
| **Unmanaged** | Agents without owners/sponsors | **Assign sponsors** |
| **Active** | Agents enabled for access | Track active count |
| **No identities** | Agents without identities | **Remediate** |

### Types of Agents Chart

| Type | Description |
|------|-------------|
| Agent identities (with no user) | Standalone agent identities |
| Agent identities (with user) | User-delegated agents |
| Agents with service principals | Service principal-based agents |
| Agents with no identities | Unregistered agents |

### Agent Blueprints

Agent blueprints are parent templates that power agent identities in your tenant. Monitor blueprint usage for governance.

### Agent Collections Overview

| Collection | Count | Description |
|------------|-------|-------------|
| Global | Count | Visible to all identities |
| Quarantined | Count | Hidden from all identities |
| Custom | Count | Organization-defined collections |

---

## All Agent Identities

### Actions

| Action | Description |
|--------|-------------|
| **Disable** | Disable selected agents |
| **Refresh** | Update agent list |
| **Choose Columns** | Customize view |
| **View agent blueprints** | See blueprint templates |

### Agent Identities Table

| Column | Description |
|--------|-------------|
| Name | Agent name and platform (e.g., Microsoft Copilot Studio) |
| Created on | Creation date |
| Status | Active, Disabled |
| Object ID | Entra object identifier |

---

## Agent Registry (Preview)

The Agent Registry provides cross-platform agent discovery.

Description: "Review all agents and their data in your tenant. See how they connect to your identity and security setup."

### Registry Table Columns

| Column | Description |
|--------|-------------|
| Name | Agent name |
| Registry ID | Unique registry identifier |
| Created in | Source platform |
| Has Agent ID | Whether agent has Entra identity |
| Source ID | Source system identifier |

---

## Agent Collections (Preview)

Agent collections group agents by trust level and visibility.

### Predefined Collections

| Collection | Description | Discovered By |
|------------|-------------|---------------|
| **Global** | Visible to all identities in tenant | All users and agents |
| **Quarantined** | Not visible to any identities | No users or agents |

### Custom Collections

Create custom collections for organization-specific groupings (e.g., by department, risk level, or zone).

> **FSI Recommendation:** Use Quarantined collection for agents under review or suspected of compromise.

---

## Agent Sign-in Logs (Preview)

### Log Filters

| Filter | Options |
|--------|---------|
| Date range | Last 24 hours, custom |
| Is Agent | Yes (filter for agents only) |
| Add filter | Additional criteria |

### Sign-in Log Tabs

| Tab | Description |
|-----|-------------|
| **User sign-ins (interactive)** | Interactive agent sign-ins |
| **User sign-ins (non-interactive)** | Background agent activity |
| **Service principal sign-ins** | Service principal authentication |
| **Managed identity sign-ins** | Managed identity activity |

### Log Table Columns

| Column | Description |
|--------|-------------|
| Date | Sign-in timestamp |
| Request ID | Unique request identifier |
| User principal name | Agent identity |
| Application | Target application |
| Status | Success, Failure |
| IP address | Source IP |
| Resource | Accessed resource |

---

## Agent Identity Governance

### Sponsorship Model

Every agent identity requires a human sponsor accountable for:
- Agent lifecycle decisions
- Access appropriateness reviews
- Compliance oversight

**Automatic Sponsorship Transfer:** When a sponsor leaves, sponsorship automatically transfers to their manager.

### Lifecycle Management

| Capability | Description | FSI Benefit |
|------------|-------------|-------------|
| **Sponsor assignment** | Human accountability | Compliance requirement |
| **Access expiration** | Time-bound access | Least privilege |
| **Automatic transfer** | Manager inheritance | No orphaned agents |
| **Lifecycle workflows** | Automated notifications | Governance efficiency |

### Access Packages for Agents

Agents can be assigned access packages for controlled resource access:

1. **Agent-initiated** - Programmatic access requests
2. **Sponsor-initiated** - Human-approved requests
3. **Administrator-initiated** - Direct assignment

---

## Governance Levels

### Level 1 - Baseline

| Requirement | Configuration |
|-------------|---------------|
| MFA enabled | All agent creators require MFA |
| Basic policies | At least one Conditional Access policy |
| Agent visibility | Access Agent ID Overview |

**Minimum requirements:**
- Enable MFA for all users
- Create baseline Conditional Access policy
- Document authentication requirements

### Level 2-3 - Recommended

| Requirement | Configuration |
|-------------|---------------|
| Risk-based policies | Sign-in and user risk policies |
| Agent monitoring | Review Agent ID dashboard weekly |
| Authentication strengths | Define strength requirements |
| Agent sponsorship | Assign sponsors to all agents |

**FSI recommendations:**
- Enable risk-based Conditional Access
- Configure authentication strengths for each zone
- Monitor Agent ID dashboard for unmanaged agents
- Establish agent sponsorship process

### Level 4 - Regulated/High-Risk

| Requirement | Configuration |
|-------------|---------------|
| Phishing-resistant MFA | FIDO2/Certificate for Zone 3 |
| Agent collections | Use Quarantined for review |
| Continuous evaluation | Real-time policy enforcement |
| Agent access packages | Time-bound agent access |

**FSI requirements:**
- Mandatory phishing-resistant MFA for Zone 3 agent creators
- All Zone 3 agents in managed collections
- Agent access via access packages with expiration
- Daily review of agent sign-in logs

---

## Verification & Testing

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | Navigate to entra.microsoft.com → Conditional Access | Overview dashboard displayed |
| 2 | Check Policy Summary | Agent Identities card shows count |
| 3 | Review Policies list | Policies visible with states |
| 4 | Navigate to Authentication methods | Method policies displayed |
| 5 | Navigate to Agent ID (Preview) | Agent overview with metrics |
| 6 | Check All agent identities | Agent list with status |
| 7 | Review Agent collections | Global and Quarantined visible |
| 8 | Check Sign-in logs (Is Agent: Yes) | Agent sign-ins logged |

---

## Regulatory Context

**Primary Regulations:** GLBA 501(b), FINRA 4511, SEC Reg SHO, SOX 302

| Regulation | Conditional Access Support |
|------------|---------------------------|
| GLBA 501(b) | Strong authentication requirements |
| FINRA 4511 | Access control and audit trails |
| SEC Reg SHO | Identity verification controls |
| SOX 302 | Internal access controls |

### Examination Considerations

Regulators may request:
- Conditional Access policy configuration
- Authentication method settings
- Agent identity inventory
- Agent sponsor assignments
- Sign-in logs for agents

---

## Related Controls

- [Control 1.4: Advanced Connector Policies](./1.4-advanced-connector-policies-acp.md) - Connector access control
- [Control 1.12: Insider Risk Detection](./1.12-insider-risk-detection-and-response.md) - Risk management
- [Control 3.8: Copilot Command Center](../pillar-3-reporting/3.8-copilot-command-center.md) - Agent management
- [Control 3.1: Agent Inventory](../pillar-3-reporting/3.1-agent-inventory-and-metadata-management.md) - Agent tracking

---

## Microsoft Learn References

- [What is Microsoft Entra Agent ID?](https://learn.microsoft.com/en-us/entra/agent-id/identity-professional/microsoft-entra-agent-identities-for-ai-agents)
- [Governing Agent Identities](https://learn.microsoft.com/en-us/entra/id-governance/agent-id-governance-overview)
- [Conditional Access overview](https://learn.microsoft.com/en-us/entra/identity/conditional-access/overview)
- [Authentication methods](https://learn.microsoft.com/en-us/entra/identity/authentication/concept-authentication-methods)

---

## Support & Questions

For implementation support or questions about this control, contact:
- AI Governance Lead (governance direction)
- Identity Administrator (Entra configuration)
- Compliance Officer (regulatory requirements)

---

*Last Updated: December 2025*
*Version: 1.0 Beta*
