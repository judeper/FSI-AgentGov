# Control 3.9: Microsoft Sentinel Integration

## Overview

**Control ID:** 3.9
**Control Name:** Microsoft Sentinel Integration
**Regulatory Reference:** OCC Heightened Standards, Fed SR 11-7, FINRA 4370, SOX 404
**Setup Time:** 8-16 hours (requires Azure subscription)

---

## Description

Microsoft Sentinel provides SIEM (Security Information and Event Management) and XDR (Extended Detection and Response) capabilities for Power Platform and Copilot Studio agents. Integration enables advanced threat detection, security analytics, and automated incident response for enterprise AI deployments.

See [What is Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/overview) for detailed capabilities.

---

## Key Capabilities

| Capability | Description | FSI Relevance |
|------------|-------------|---------------|
| **Centralized SIEM** | Unified security monitoring | SOC integration |
| **Threat detection** | Analytics rules for AI threats | Proactive security |
| **Incident management** | Security incident workflow | Response coordination |
| **Automation** | Automated response playbooks | Rapid remediation |
| **Hunting** | Proactive threat hunting | Advanced investigation |

---

## Sentinel Navigation

### Accessing Microsoft Sentinel

1. Open [Azure Portal](https://portal.azure.com)
2. Search for **Microsoft Sentinel**
3. Select workspace or create new

### Workspace List

| Column | Description |
|--------|-------------|
| Name | Workspace identifier |
| Resource Group | Azure resource group |
| Location | Azure region |
| Subscription | Azure subscription |
| Directory | Azure AD tenant |

### Workspace Sections

**General:**
- Overview - Dashboard with key metrics
- Logs - Query and analyze data
- Guides - Setup and configuration guides
- Search - Search across data

**Threat Management:**
- Incidents - Security incident management
- Workbooks - Visual analytics dashboards
- Hunting - Proactive threat hunting queries
- Notebooks - Jupyter notebooks for investigation
- Entity behavior - User and entity analytics
- Threat intelligence - Threat intel integration
- MITRE ATT&CK (Preview) - Framework mapping
- SOC optimization - Efficiency recommendations

**Content Management:**
- Content hub - Solutions and connectors
- Repositories - Version-controlled content
- Community - Community content

**Configuration:**
- Workspace manager (Preview) - Multi-workspace management
- Data connectors - Connect data sources
- Analytics - Detection rules
- Summary rules - Data summarization
- Watchlist - Reference data lists
- Automation - Response playbooks
- Settings - Workspace configuration

---

## Power Platform Data Connector

### Connecting Power Platform to Sentinel

1. Navigate to Sentinel workspace → **Data connectors**
2. Search for "Power Platform" in Content hub
3. Install Power Platform connector
4. Configure connection settings
5. Enable data collection

### Data Available from Power Platform

| Data Type | Description | Use Case |
|-----------|-------------|----------|
| Admin activity | PPAC administrative actions | Admin monitoring |
| Maker activity | App/flow/agent creation | Shadow AI detection |
| DLP violations | Data loss prevention events | Compliance monitoring |
| Connector usage | Connector activity | Security analysis |

---

## Analytics Rules for Agents

### Creating Detection Rules

1. Navigate to **Analytics** in Configuration
2. Click **Create** → **Scheduled query rule**
3. Define rule logic using KQL
4. Set alert threshold and frequency
5. Configure incident creation
6. Enable rule

### Recommended Rules for FSI

| Rule | Description | Severity |
|------|-------------|----------|
| Unauthorized agent creation | Detect agents in ungoverned environments | High |
| Sensitive data in agent interactions | Alert on PII/financial data exposure | High |
| Agent sharing anomaly | Unusual sharing patterns | Medium |
| Failed agent authentications | Multiple auth failures | Medium |
| High-volume agent usage | Abnormal usage patterns | Low |

---

## Incident Management

### Incident Dashboard

| Metric | Description |
|--------|-------------|
| Incidents (24h) | New incidents in last 24 hours |
| Severity breakdown | Incidents by severity level |
| Status | Open, In progress, Closed |
| Owner | Assigned analyst |

### Incident Workflow

1. **Triage** - Review and assign severity
2. **Investigate** - Analyze related data
3. **Respond** - Take remediation actions
4. **Document** - Record findings and actions
5. **Close** - Close with classification

---

## Automation

### Automation Rules

Create rules to automatically handle incidents:

| Trigger | Action | Example |
|---------|--------|---------|
| Incident created | Assign owner | Route agent incidents to AI team |
| Severity = High | Run playbook | Notify security on critical alerts |
| Source = Power Platform | Add tag | Tag for compliance tracking |

### Playbooks

Automated response using Logic Apps:

| Playbook | Purpose |
|----------|---------|
| Notify SOC | Send Teams/email notification |
| Block user | Disable account for insider threat |
| Create ticket | Open ServiceNow ticket |
| Enrich data | Add context from threat intel |

---

## Governance Levels

### Level 1 - Baseline

| Requirement | Configuration |
|-------------|---------------|
| Sentinel awareness | Understand capabilities |
| Basic logging | Power Platform audit logs retained |
| Documentation | Document security monitoring approach |

**Minimum requirements:**
- Understand Sentinel integration options
- Ensure audit logging enabled in Power Platform
- Document security monitoring requirements

### Level 2-3 - Recommended

| Requirement | Configuration |
|-------------|---------------|
| Sentinel workspace | Dedicated workspace for Power Platform |
| Data connector | Power Platform connector enabled |
| Basic analytics | Key detection rules enabled |
| Incident process | Defined incident handling |

**FSI recommendations:**
- Deploy Sentinel workspace for Power Platform logs
- Enable Power Platform data connector
- Create analytics rules for agent security
- Define incident response procedures

### Level 4 - Regulated/High-Risk

| Requirement | Configuration |
|-------------|---------------|
| Comprehensive monitoring | All Power Platform data in Sentinel |
| Advanced analytics | Full rule set for agent threats |
| Automation | Playbooks for automated response |
| SOC integration | 24/7 monitoring coverage |
| Threat hunting | Regular proactive hunting |

**FSI requirements:**
- 24/7 SOC monitoring of agent security events
- Automated incident response for high-severity alerts
- Regular threat hunting for AI-related threats
- Integration with enterprise SIEM if not Sentinel
- Quarterly security posture reviews

---

## Integration with Defender Portal

### Unified SecOps Platform

Sentinel integrates with Microsoft Defender for unified security:

- **Security Copilot** - AI-assisted security investigation
- **Unified incidents** - Cross-product incident correlation
- **XDR capabilities** - Extended detection and response

---

## Verification & Testing

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | Navigate to Azure Portal → Microsoft Sentinel | Sentinel accessible |
| 2 | Verify workspace exists | Workspace listed |
| 3 | Check Data connectors | Power Platform connector available |
| 4 | Review Analytics rules | Rules configured and enabled |
| 5 | Test incident creation | Test alert generates incident |
| 6 | Verify automation | Playbooks execute correctly |

---

## Licensing and Prerequisites

| Requirement | Details |
|-------------|---------|
| Azure subscription | Required for Sentinel |
| Log Analytics workspace | Sentinel runs on Log Analytics |
| Sentinel pricing | Pay-per-GB ingested |
| Power Platform licensing | Admin access for connector |
| Security permissions | Security Administrator role |

---

## Regulatory Context

**Primary Regulations:** OCC Heightened Standards, Fed SR 11-7, FINRA 4370, SOX 404

| Regulation | Sentinel Support |
|------------|------------------|
| OCC Heightened Standards | Enterprise security monitoring |
| Fed SR 11-7 | Model risk monitoring |
| FINRA 4370 | Business continuity security |
| SOX 404 | IT security controls |

### Examination Considerations

Regulators may request:
- Security monitoring architecture documentation
- Incident response procedures
- Detection rule inventory
- Incident history and resolution
- Evidence of proactive threat hunting

---

## Related Controls

- [Control 3.2: Usage Analytics](./3.2-usage-analytics-and-activity-monitoring.md) - Platform monitoring
- [Control 1.7: Audit Logging](../pillar-1-security/1.7-comprehensive-audit-logging-and-compliance.md) - Activity logging
- [Control 1.8: Runtime Protection](../pillar-1-security/1.8-runtime-protection-and-external-threat-detection.md) - Threat detection
- [Control 3.4: Incident Reporting](./3.4-incident-reporting-and-root-cause-analysis.md) - Incident management

---

## Support & Questions

For implementation support or questions about this control, contact:
- Security Operations Center (SOC monitoring)
- Azure Administrator (Sentinel setup)
- AI Governance Lead (agent security requirements)

---

*Last Updated: December 2025*
*Version: 1.0 Beta*
